"use strict";(self.webpackChunkpeter_wooldridge_blog=self.webpackChunkpeter_wooldridge_blog||[]).push([[1371],{4007:function(t,e,a){a.d(e,{DA:function(){return b},IU:function(){return T},KX:function(){return M},U:function(){return P},U7:function(){return Ae},U_:function(){return Ke},Zk:function(){return h},aP:function(){return ve},gh:function(){return Be},lC:function(){return g},on:function(){return De}});var n=a(2355),s=a(9227),l=a(6137),r=a(5395),i=a(2362),o=a(4852),c=a(2274),h=(0,i.K2)((async(t,e,a)=>{let n;const s=e.useHtmlLabels||(0,i._3)((0,i.D7)()?.htmlLabels);n=a||"node default";const c=t.insert("g").attr("class",n).attr("id",e.domId||e.id),h=c.insert("g").attr("class","label").attr("style",(0,r.KL)(e.labelStyle));let d;d=void 0===e.label?"":"string"==typeof e.label?e.label:e.label[0];const g=await(0,l.GZ)(h,(0,i.jZ)((0,r.Sm)(d),(0,i.D7)()),{useHtmlLabels:s,width:e.width||(0,i.D7)().flowchart?.wrappingWidth,cssClasses:"markdown-node-label",style:e.labelStyle,addSvgBackground:!!e.icon||!!e.img});let y=g.getBBox();const p=(e?.padding??0)/2;if(s){const t=g.children[0],e=(0,o.Ltv)(g),a=t.getElementsByTagName("img");if(a){const t=""===d.replace(/<img[^>]*>/g,"").trim();await Promise.all([...a].map((e=>new Promise((a=>{function n(){if(e.style.display="flex",e.style.flexDirection="column",t){const t=(0,i.D7)().fontSize?(0,i.D7)().fontSize:window.getComputedStyle(document.body).fontSize,a=5,[n=i.UI.fontSize]=(0,r.I5)(t),s=n*a+"px";e.style.minWidth=s,e.style.maxWidth=s}else e.style.width="100%";a(e)}(0,i.K2)(n,"setupImage"),setTimeout((()=>{e.complete&&n()})),e.addEventListener("error",n),e.addEventListener("load",n)})))))}y=t.getBoundingClientRect(),e.attr("width",y.width),e.attr("height",y.height)}return s?h.attr("transform","translate("+-y.width/2+", "+-y.height/2+")"):h.attr("transform","translate(0, "+-y.height/2+")"),e.centerLabel&&h.attr("transform","translate("+-y.width/2+", "+-y.height/2+")"),h.insert("rect",":first-child"),{shapeSvg:c,bbox:y,halfPadding:p,label:h}}),"labelHelper"),d=(0,i.K2)((async(t,e,a)=>{const n=a.useHtmlLabels||(0,i._3)((0,i.D7)()?.flowchart?.htmlLabels),s=t.insert("g").attr("class","label").attr("style",a.labelStyle||""),c=await(0,l.GZ)(s,(0,i.jZ)((0,r.Sm)(e),(0,i.D7)()),{useHtmlLabels:n,width:a.width||(0,i.D7)()?.flowchart?.wrappingWidth,style:a.labelStyle,addSvgBackground:!!a.icon||!!a.img});let h=c.getBBox();const d=a.padding/2;if((0,i._3)((0,i.D7)()?.flowchart?.htmlLabels)){const t=c.children[0],e=(0,o.Ltv)(c);h=t.getBoundingClientRect(),e.attr("width",h.width),e.attr("height",h.height)}return n?s.attr("transform","translate("+-h.width/2+", "+-h.height/2+")"):s.attr("transform","translate(0, "+-h.height/2+")"),a.centerLabel&&s.attr("transform","translate("+-h.width/2+", "+-h.height/2+")"),s.insert("rect",":first-child"),{shapeSvg:t,bbox:h,halfPadding:d,label:s}}),"insertLabel"),g=(0,i.K2)(((t,e)=>{const a=e.node().getBBox();t.width=a.width,t.height=a.height}),"updateNodeBounds"),y=(0,i.K2)(((t,e)=>("handDrawn"===t.look?"rough-node":"node")+" "+t.cssClasses+" "+(e||"")),"getNodeClasses");function p(t){const e=t.map(((t,e)=>`${0===e?"M":"L"}${t.x},${t.y}`));return e.push("Z"),e.join(" ")}function f(t,e,a,n,s,l){const r=[],i=a-t,o=n-e,c=i/l,h=2*Math.PI/c,d=e+o/2;for(let g=0;g<=50;g++){const e=t+g/50*i,a=d+s*Math.sin(h*(e-t));r.push({x:e,y:a})}return r}function u(t,e,a,n,s,l){const r=[],i=s*Math.PI/180,o=(l*Math.PI/180-i)/(n-1);for(let c=0;c<n;c++){const n=i+c*o,s=t+a*Math.cos(n),l=e+a*Math.sin(n);r.push({x:-s,y:-l})}return r}(0,i.K2)(p,"createPathFromPoints"),(0,i.K2)(f,"generateFullSineWavePoints"),(0,i.K2)(u,"generateCirclePoints");var m=(0,i.K2)(((t,e)=>{var a,n,s=t.x,l=t.y,r=e.x-s,i=e.y-l,o=t.width/2,c=t.height/2;return Math.abs(i)*o>Math.abs(r)*c?(i<0&&(c=-c),a=0===i?0:c*r/i,n=c):(r<0&&(o=-o),a=o,n=0===r?0:o*i/r),{x:s+a,y:l+n}}),"intersectRect");function x(t,e){e&&t.attr("style",e)}async function w(t){const e=(0,o.Ltv)(document.createElementNS("http://www.w3.org/2000/svg","foreignObject")),a=e.append("xhtml:div");let n=t.label;t.label&&(0,i.Wi)(t.label)&&(n=await(0,i.VJ)(t.label.replace(i.Y2.lineBreakRegex,"\n"),(0,i.D7)()));const s=t.isNode?"nodeLabel":"edgeLabel";return a.html('<span class="'+s+'" '+(t.labelStyle?'style="'+t.labelStyle+'"':"")+">"+n+"</span>"),x(a,t.labelStyle),a.style("display","inline-block"),a.style("padding-right","1px"),a.style("white-space","nowrap"),a.attr("xmlns","http://www.w3.org/1999/xhtml"),e.node()}(0,i.K2)(x,"applyStyle"),(0,i.K2)(w,"addHtmlLabel");var b=(0,i.K2)((async(t,e,a,n)=>{let s=t||"";if("object"==typeof s&&(s=s[0]),(0,i._3)((0,i.D7)().flowchart.htmlLabels)){s=s.replace(/\\n|\n/g,"<br />"),i.Rm.info("vertexText"+s);const t={isNode:n,label:(0,r.Sm)(s).replace(/fa[blrs]?:fa-[\w-]+/g,(t=>`<i class='${t.replace(":"," ")}'></i>`)),labelStyle:e?e.replace("fill:","color:"):e};return await w(t)}{const t=document.createElementNS("http://www.w3.org/2000/svg","text");t.setAttribute("style",e.replace("color:","fill:"));let n=[];n="string"==typeof s?s.split(/\\n|\n|<br\s*\/?>/gi):Array.isArray(s)?s:[];for(const e of n){const n=document.createElementNS("http://www.w3.org/2000/svg","tspan");n.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),n.setAttribute("dy","1em"),n.setAttribute("x","0"),a?n.setAttribute("class","title-row"):n.setAttribute("class","row"),n.textContent=e.trim(),t.appendChild(n)}return t}}),"createLabel"),S=(0,i.K2)(((t,e,a,n,s)=>["M",t+s,e,"H",t+a-s,"A",s,s,0,0,1,t+a,e+s,"V",e+n-s,"A",s,s,0,0,1,t+a-s,e+n,"H",t+s,"A",s,s,0,0,1,t,e+n-s,"V",e+s,"A",s,s,0,0,1,t+s,e,"Z"].join(" ")),"createRoundedRectPathD"),$=(0,i.K2)((t=>{const{handDrawnSeed:e}=(0,i.D7)();return{fill:t,hachureAngle:120,hachureGap:4,fillWeight:2,roughness:.7,stroke:t,seed:e}}),"solidStateFill"),k=(0,i.K2)((t=>{const e=v([...t.cssCompiledStyles||[],...t.cssStyles||[]]);return{stylesMap:e,stylesArray:[...e]}}),"compileStyles"),v=(0,i.K2)((t=>{const e=new Map;return t.forEach((t=>{const[a,n]=t.split(":");e.set(a.trim(),n?.trim())})),e}),"styles2Map"),M=(0,i.K2)((t=>"color"===t||"font-size"===t||"font-family"===t||"font-weight"===t||"font-style"===t||"text-decoration"===t||"text-align"===t||"text-transform"===t||"line-height"===t||"letter-spacing"===t||"word-spacing"===t||"text-shadow"===t||"text-overflow"===t||"white-space"===t||"word-wrap"===t||"word-break"===t||"overflow-wrap"===t||"hyphens"===t),"isLabelStyle"),D=(0,i.K2)((t=>{const{stylesArray:e}=k(t),a=[],n=[],s=[],l=[];return e.forEach((t=>{const e=t[0];M(e)?a.push(t.join(":")+" !important"):(n.push(t.join(":")+" !important"),e.includes("stroke")&&s.push(t.join(":")+" !important"),"fill"===e&&l.push(t.join(":")+" !important"))})),{labelStyles:a.join(";"),nodeStyles:n.join(";"),stylesArray:e,borderStyles:s,backgroundStyles:l}}),"styles2String"),A=(0,i.K2)(((t,e)=>{const{themeVariables:a,handDrawnSeed:n}=(0,i.D7)(),{nodeBorder:s,mainBkg:l}=a,{stylesMap:r}=k(t);return Object.assign({roughness:.7,fill:r.get("fill")||l,fillStyle:"hachure",fillWeight:4,hachureGap:5.2,stroke:r.get("stroke")||s,seed:n,strokeWidth:r.get("stroke-width")?.replace("px","")||1.3,fillLineDash:[0,0]},e)}),"userNodeOverrides"),B=(0,i.K2)((async(t,e)=>{i.Rm.info("Creating subgraph rect for ",e.id,e);const a=(0,i.D7)(),{themeVariables:s,handDrawnSeed:r}=a,{clusterBkg:h,clusterBorder:d}=s,{labelStyles:g,nodeStyles:y,borderStyles:p,backgroundStyles:f}=D(e),u=t.insert("g").attr("class","cluster "+e.cssClasses).attr("id",e.id).attr("data-look",e.look),x=(0,i._3)(a.flowchart.htmlLabels),w=u.insert("g").attr("class","cluster-label "),b=await(0,l.GZ)(w,e.label,{style:e.labelStyle,useHtmlLabels:x,isNode:!0});let $=b.getBBox();if((0,i._3)(a.flowchart.htmlLabels)){const t=b.children[0],e=(0,o.Ltv)(b);$=t.getBoundingClientRect(),e.attr("width",$.width),e.attr("height",$.height)}const k=e.width<=$.width+e.padding?$.width+e.padding:e.width;e.width<=$.width+e.padding?e.diff=(k-e.width)/2-e.padding:e.diff=-e.padding;const v=e.height,M=e.x-k/2,B=e.y-v/2;let K;if(i.Rm.trace("Data ",e,JSON.stringify(e)),"handDrawn"===e.look){const t=c.A.svg(u),a=A(e,{roughness:.7,fill:h,stroke:d,fillWeight:3,seed:r}),n=t.path(S(M,B,k,v,0),a);K=u.insert((()=>(i.Rm.debug("Rough node insert CXC",n),n)),":first-child"),K.select("path:nth-child(2)").attr("style",p.join(";")),K.select("path").attr("style",f.join(";").replace("fill","stroke"))}else K=u.insert("rect",":first-child"),K.attr("style",y).attr("rx",e.rx).attr("ry",e.ry).attr("x",M).attr("y",B).attr("width",k).attr("height",v);const{subGraphTitleTopMargin:C}=(0,n.O)(a);if(w.attr("transform",`translate(${e.x-$.width/2}, ${e.y-e.height/2+C})`),g){const t=w.select("span");t&&t.attr("style",g)}const L=K.node().getBBox();return e.offsetX=0,e.width=L.width,e.height=L.height,e.offsetY=$.height-e.padding/2,e.intersect=function(t){return m(e,t)},{cluster:u,labelBBox:$}}),"rect"),K=(0,i.K2)(((t,e)=>{const a=t.insert("g").attr("class","note-cluster").attr("id",e.id),n=a.insert("rect",":first-child"),s=0*e.padding,l=s/2;n.attr("rx",e.rx).attr("ry",e.ry).attr("x",e.x-e.width/2-l).attr("y",e.y-e.height/2-l).attr("width",e.width+s).attr("height",e.height+s).attr("fill","none");const r=n.node().getBBox();return e.width=r.width,e.height=r.height,e.intersect=function(t){return m(e,t)},{cluster:a,labelBBox:{width:0,height:0}}}),"noteGroup"),C=(0,i.K2)((async(t,e)=>{const a=(0,i.D7)(),{themeVariables:n,handDrawnSeed:s}=a,{altBackground:l,compositeBackground:r,compositeTitleBackground:h,nodeBorder:d}=n,g=t.insert("g").attr("class",e.cssClasses).attr("id",e.id).attr("data-id",e.id).attr("data-look",e.look),y=g.insert("g",":first-child"),p=g.insert("g").attr("class","cluster-label");let f=g.append("rect");const u=p.node().appendChild(await b(e.label,e.labelStyle,void 0,!0));let x=u.getBBox();if((0,i._3)(a.flowchart.htmlLabels)){const t=u.children[0],e=(0,o.Ltv)(u);x=t.getBoundingClientRect(),e.attr("width",x.width),e.attr("height",x.height)}const w=0*e.padding,$=w/2,k=(e.width<=x.width+e.padding?x.width+e.padding:e.width)+w;e.width<=x.width+e.padding?e.diff=(k-e.width)/2-e.padding:e.diff=-e.padding;const v=e.height+w,M=e.height+w-x.height-6,D=e.x-k/2,A=e.y-v/2;e.width=k;const B=e.y-e.height/2-$+x.height+2;let K;if("handDrawn"===e.look){const t=e.cssClasses.includes("statediagram-cluster-alt"),a=c.A.svg(g),n=e.rx||e.ry?a.path(S(D,A,k,v,10),{roughness:.7,fill:h,fillStyle:"solid",stroke:d,seed:s}):a.rectangle(D,A,k,v,{seed:s});K=g.insert((()=>n),":first-child");const i=a.rectangle(D,B,k,M,{fill:t?l:r,fillStyle:t?"hachure":"solid",stroke:d,seed:s});K=g.insert((()=>n),":first-child"),f=g.insert((()=>i))}else{K=y.insert("rect",":first-child");const t="outer";K.attr("class",t).attr("x",D).attr("y",A).attr("width",k).attr("height",v).attr("data-look",e.look),f.attr("class","inner").attr("x",D).attr("y",B).attr("width",k).attr("height",M)}p.attr("transform",`translate(${e.x-x.width/2}, ${A+1-((0,i._3)(a.flowchart.htmlLabels)?0:3)})`);const C=K.node().getBBox();return e.height=C.height,e.offsetX=0,e.offsetY=x.height-e.padding/2,e.labelBBox=x,e.intersect=function(t){return m(e,t)},{cluster:g,labelBBox:x}}),"roundedWithTitle"),L=(0,i.K2)((async(t,e)=>{i.Rm.info("Creating subgraph rect for ",e.id,e);const a=(0,i.D7)(),{themeVariables:s,handDrawnSeed:r}=a,{clusterBkg:h,clusterBorder:d}=s,{labelStyles:g,nodeStyles:y,borderStyles:p,backgroundStyles:f}=D(e),u=t.insert("g").attr("class","cluster "+e.cssClasses).attr("id",e.id).attr("data-look",e.look),x=(0,i._3)(a.flowchart.htmlLabels),w=u.insert("g").attr("class","cluster-label "),b=await(0,l.GZ)(w,e.label,{style:e.labelStyle,useHtmlLabels:x,isNode:!0,width:e.width});let $=b.getBBox();if((0,i._3)(a.flowchart.htmlLabels)){const t=b.children[0],e=(0,o.Ltv)(b);$=t.getBoundingClientRect(),e.attr("width",$.width),e.attr("height",$.height)}const k=e.width<=$.width+e.padding?$.width+e.padding:e.width;e.width<=$.width+e.padding?e.diff=(k-e.width)/2-e.padding:e.diff=-e.padding;const v=e.height,M=e.x-k/2,B=e.y-v/2;let K;if(i.Rm.trace("Data ",e,JSON.stringify(e)),"handDrawn"===e.look){const t=c.A.svg(u),a=A(e,{roughness:.7,fill:h,stroke:d,fillWeight:4,seed:r}),n=t.path(S(M,B,k,v,e.rx),a);K=u.insert((()=>(i.Rm.debug("Rough node insert CXC",n),n)),":first-child"),K.select("path:nth-child(2)").attr("style",p.join(";")),K.select("path").attr("style",f.join(";").replace("fill","stroke"))}else K=u.insert("rect",":first-child"),K.attr("style",y).attr("rx",e.rx).attr("ry",e.ry).attr("x",M).attr("y",B).attr("width",k).attr("height",v);const{subGraphTitleTopMargin:C}=(0,n.O)(a);if(w.attr("transform",`translate(${e.x-$.width/2}, ${e.y-e.height/2+C})`),g){const t=w.select("span");t&&t.attr("style",g)}const L=K.node().getBBox();return e.offsetX=0,e.width=L.width,e.height=L.height,e.offsetY=$.height-e.padding/2,e.intersect=function(t){return m(e,t)},{cluster:u,labelBBox:$}}),"kanbanSection"),N={rect:B,squareRect:B,roundedWithTitle:C,noteGroup:K,divider:(0,i.K2)(((t,e)=>{const a=(0,i.D7)(),{themeVariables:n,handDrawnSeed:s}=a,{nodeBorder:l}=n,r=t.insert("g").attr("class",e.cssClasses).attr("id",e.id).attr("data-look",e.look),o=r.insert("g",":first-child"),h=0*e.padding,d=e.width+h;e.diff=-e.padding;const g=e.height+h,y=e.x-d/2,p=e.y-g/2;let f;if(e.width=d,"handDrawn"===e.look){const t=c.A.svg(r).rectangle(y,p,d,g,{fill:"lightgrey",roughness:.5,strokeLineDash:[5],stroke:l,seed:s});f=r.insert((()=>t),":first-child")}else{f=o.insert("rect",":first-child");const t="divider";f.attr("class",t).attr("x",y).attr("y",p).attr("width",d).attr("height",g).attr("data-look",e.look)}const u=f.node().getBBox();return e.height=u.height,e.offsetX=0,e.offsetY=0,e.intersect=function(t){return m(e,t)},{cluster:r,labelBBox:{}}}),"divider"),kanbanSection:L},R=new Map,P=(0,i.K2)((async(t,e)=>{const a=e.shape||"rect",n=await N[a](t,e);return R.set(e.id,n),n}),"insertCluster"),T=(0,i.K2)((()=>{R=new Map}),"clear");function I(t,e){return t.intersect(e)}(0,i.K2)(I,"intersectNode");var j=I;function W(t,e,a,n){var s=t.x,l=t.y,r=s-n.x,i=l-n.y,o=Math.sqrt(e*e*i*i+a*a*r*r),c=Math.abs(e*a*r/o);n.x<s&&(c=-c);var h=Math.abs(e*a*i/o);return n.y<l&&(h=-h),{x:s+c,y:l+h}}(0,i.K2)(W,"intersectEllipse");var _=W;function E(t,e,a){return _(t,e,e,a)}(0,i.K2)(E,"intersectCircle");var H=E;function z(t,e,a,n){var s,l,r,i,o,c,h,d,g,y,p,f,u;if(s=e.y-t.y,r=t.x-e.x,o=e.x*t.y-t.x*e.y,g=s*a.x+r*a.y+o,y=s*n.x+r*n.y+o,!(0!==g&&0!==y&&q(g,y)||(l=n.y-a.y,i=a.x-n.x,c=n.x*a.y-a.x*n.y,h=l*t.x+i*t.y+c,d=l*e.x+i*e.y+c,0!==h&&0!==d&&q(h,d)||0==(p=s*i-l*r))))return f=Math.abs(p/2),{x:(u=r*c-i*o)<0?(u-f)/p:(u+f)/p,y:(u=l*o-s*c)<0?(u-f)/p:(u+f)/p}}function q(t,e){return t*e>0}(0,i.K2)(z,"intersectLine"),(0,i.K2)(q,"sameSign");var V=z;function O(t,e,a){let n=t.x,s=t.y,l=[],r=Number.POSITIVE_INFINITY,i=Number.POSITIVE_INFINITY;"function"==typeof e.forEach?e.forEach((function(t){r=Math.min(r,t.x),i=Math.min(i,t.y)})):(r=Math.min(r,e.x),i=Math.min(i,e.y));let o=n-t.width/2-r,c=s-t.height/2-i;for(let h=0;h<e.length;h++){let n=e[h],s=e[h<e.length-1?h+1:0],r=V(t,a,{x:o+n.x,y:c+n.y},{x:o+s.x,y:c+s.y});r&&l.push(r)}return l.length?(l.length>1&&l.sort((function(t,e){let n=t.x-a.x,s=t.y-a.y,l=Math.sqrt(n*n+s*s),r=e.x-a.x,i=e.y-a.y,o=Math.sqrt(r*r+i*i);return l<o?-1:l===o?0:1})),l[0]):t}(0,i.K2)(O,"intersectPolygon");var F={node:j,circle:H,ellipse:_,polygon:O,rect:m};function Z(t,e){const{labelStyles:a}=D(e);e.labelStyle=a;const n=y(e);let s=n;n||(s="anchor");const l=t.insert("g").attr("class",s).attr("id",e.domId||e.id),{cssStyles:o}=e,h=c.A.svg(l),d=A(e,{fill:"black",stroke:"none",fillStyle:"solid"});"handDrawn"!==e.look&&(d.roughness=0);const p=h.circle(0,0,2,d),f=l.insert((()=>p),":first-child");return f.attr("class","anchor").attr("style",(0,r.KL)(o)),g(e,f),e.intersect=function(t){return i.Rm.info("Circle intersect",e,1,t),F.circle(e,1,t)},l}function X(t,e,a,n,s,l,r){const i=(t+a)/2,o=(e+n)/2,c=Math.atan2(n-e,a-t),h=(a-t)/2/s,d=(n-e)/2/l,g=Math.sqrt(h**2+d**2);if(g>1)throw new Error("The given radii are too small to create an arc between the points.");const y=Math.sqrt(1-g**2),p=i+y*l*Math.sin(c)*(r?-1:1),f=o-y*s*Math.cos(c)*(r?-1:1),u=Math.atan2((e-f)/l,(t-p)/s);let m=Math.atan2((n-f)/l,(a-p)/s)-u;r&&m<0&&(m+=2*Math.PI),!r&&m>0&&(m-=2*Math.PI);const x=[];for(let w=0;w<20;w++){const t=u+w/19*m,e=p+s*Math.cos(t),a=f+l*Math.sin(t);x.push({x:e,y:a})}return x}async function Y(t,e){const{labelStyles:a,nodeStyles:n}=D(e);e.labelStyle=a;const{shapeSvg:s,bbox:l}=await h(t,e,y(e)),r=l.width+e.padding+20,i=l.height+e.padding,o=i/2,d=o/(2.5+i/50),{cssStyles:f}=e,u=[{x:r/2,y:-i/2},{x:-r/2,y:-i/2},...X(-r/2,-i/2,-r/2,i/2,d,o,!1),{x:r/2,y:i/2},...X(r/2,i/2,r/2,-i/2,d,o,!0)],m=c.A.svg(s),x=A(e,{});"handDrawn"!==e.look&&(x.roughness=0,x.fillStyle="solid");const w=p(u),b=m.path(w,x),S=s.insert((()=>b),":first-child");return S.attr("class","basic label-container"),f&&"handDrawn"!==e.look&&S.selectAll("path").attr("style",f),n&&"handDrawn"!==e.look&&S.selectAll("path").attr("style",n),S.attr("transform",`translate(${d/2}, 0)`),g(e,S),e.intersect=function(t){return F.polygon(e,u,t)},s}function G(t,e,a,n){return t.insert("polygon",":first-child").attr("points",n.map((function(t){return t.x+","+t.y})).join(" ")).attr("class","label-container").attr("transform","translate("+-e/2+","+a/2+")")}async function U(t,e){const{labelStyles:a,nodeStyles:n}=D(e);e.labelStyle=a;const{shapeSvg:s,bbox:l}=await h(t,e,y(e)),r=l.height+e.padding,i=l.width+e.padding+12,o=-r,d=[{x:12,y:o},{x:i,y:o},{x:i,y:0},{x:0,y:0},{x:0,y:o+12},{x:12,y:o}];let f;const{cssStyles:u}=e;if("handDrawn"===e.look){const t=c.A.svg(s),a=A(e,{}),n=p(d),l=t.path(n,a);f=s.insert((()=>l),":first-child").attr("transform",`translate(${-i/2}, ${r/2})`),u&&f.attr("style",u)}else f=G(s,i,r,d);return n&&f.attr("style",n),g(e,f),e.intersect=function(t){return F.polygon(e,d,t)},s}function J(t,e){const{nodeStyles:a}=D(e);e.label="";const n=t.insert("g").attr("class",y(e)).attr("id",e.domId??e.id),{cssStyles:s}=e,l=Math.max(28,e.width??0),r=[{x:0,y:l/2},{x:l/2,y:0},{x:0,y:-l/2},{x:-l/2,y:0}],i=c.A.svg(n),o=A(e,{});"handDrawn"!==e.look&&(o.roughness=0,o.fillStyle="solid");const h=p(r),d=i.path(h,o),g=n.insert((()=>d),":first-child");return s&&"handDrawn"!==e.look&&g.selectAll("path").attr("style",s),a&&"handDrawn"!==e.look&&g.selectAll("path").attr("style",a),e.width=28,e.height=28,e.intersect=function(t){return F.polygon(e,r,t)},n}async function Q(t,e){const{labelStyles:a,nodeStyles:n}=D(e);e.labelStyle=a;const{shapeSvg:s,bbox:l,halfPadding:o}=await h(t,e,y(e)),d=l.width/2+o;let p;const{cssStyles:f}=e;if("handDrawn"===e.look){const t=c.A.svg(s),a=A(e,{}),n=t.circle(0,0,2*d,a);p=s.insert((()=>n),":first-child"),p.attr("class","basic label-container").attr("style",(0,r.KL)(f))}else p=s.insert("circle",":first-child").attr("class","basic label-container").attr("style",n).attr("r",d).attr("cx",0).attr("cy",0);return g(e,p),e.intersect=function(t){return i.Rm.info("Circle intersect",e,d,t),F.circle(e,d,t)},s}function tt(t){const e=Math.cos(Math.PI/4),a=Math.sin(Math.PI/4),n=2*t;return`M ${-n/2*e},${n/2*a} L ${n/2*e},${-n/2*a}\n                   M ${n/2*e},${n/2*a} L ${-n/2*e},${-n/2*a}`}function et(t,e){const{labelStyles:a,nodeStyles:n}=D(e);e.labelStyle=a,e.label="";const s=t.insert("g").attr("class",y(e)).attr("id",e.domId??e.id),l=Math.max(30,e?.width??0),{cssStyles:r}=e,o=c.A.svg(s),h=A(e,{});"handDrawn"!==e.look&&(h.roughness=0,h.fillStyle="solid");const d=o.circle(0,0,2*l,h),p=tt(l),f=o.path(p,h),u=s.insert((()=>d),":first-child");return u.insert((()=>f)),r&&"handDrawn"!==e.look&&u.selectAll("path").attr("style",r),n&&"handDrawn"!==e.look&&u.selectAll("path").attr("style",n),g(e,u),e.intersect=function(t){i.Rm.info("crossedCircle intersect",e,{radius:l,point:t});return F.circle(e,l,t)},s}function at(t,e,a,n=100,s=0,l=180){const r=[],i=s*Math.PI/180,o=(l*Math.PI/180-i)/(n-1);for(let c=0;c<n;c++){const n=i+c*o,s=t+a*Math.cos(n),l=e+a*Math.sin(n);r.push({x:-s,y:-l})}return r}async function nt(t,e){const{labelStyles:a,nodeStyles:n}=D(e);e.labelStyle=a;const{shapeSvg:s,bbox:l,label:r}=await h(t,e,y(e)),i=l.width+(e.padding??0),o=l.height+(e.padding??0),d=Math.max(5,.1*o),{cssStyles:f}=e,u=[...at(i/2,-o/2,d,30,-90,0),{x:-i/2-d,y:d},...at(i/2+2*d,-d,d,20,-180,-270),...at(i/2+2*d,d,d,20,-90,-180),{x:-i/2-d,y:-o/2},...at(i/2,o/2,d,20,0,90)],m=[{x:i/2,y:-o/2-d},{x:-i/2,y:-o/2-d},...at(i/2,-o/2,d,20,-90,0),{x:-i/2-d,y:-d},...at(i/2+.1*i,-d,d,20,-180,-270),...at(i/2+.1*i,d,d,20,-90,-180),{x:-i/2-d,y:o/2},...at(i/2,o/2,d,20,0,90),{x:-i/2,y:o/2+d},{x:i/2,y:o/2+d}],x=c.A.svg(s),w=A(e,{fill:"none"});"handDrawn"!==e.look&&(w.roughness=0,w.fillStyle="solid");const b=p(u).replace("Z",""),S=x.path(b,w),$=p(m),k=x.path($,{...w}),v=s.insert("g",":first-child");return v.insert((()=>k),":first-child").attr("stroke-opacity",0),v.insert((()=>S),":first-child"),v.attr("class","text"),f&&"handDrawn"!==e.look&&v.selectAll("path").attr("style",f),n&&"handDrawn"!==e.look&&v.selectAll("path").attr("style",n),v.attr("transform",`translate(${d}, 0)`),r.attr("transform",`translate(${-i/2+d-(l.x-(l.left??0))},${-o/2+(e.padding??0)/2-(l.y-(l.top??0))})`),g(e,v),e.intersect=function(t){return F.polygon(e,m,t)},s}function st(t,e,a,n=100,s=0,l=180){const r=[],i=s*Math.PI/180,o=(l*Math.PI/180-i)/(n-1);for(let c=0;c<n;c++){const n=i+c*o,s=t+a*Math.cos(n),l=e+a*Math.sin(n);r.push({x:s,y:l})}return r}async function lt(t,e){const{labelStyles:a,nodeStyles:n}=D(e);e.labelStyle=a;const{shapeSvg:s,bbox:l,label:r}=await h(t,e,y(e)),i=l.width+(e.padding??0),o=l.height+(e.padding??0),d=Math.max(5,.1*o),{cssStyles:f}=e,u=[...st(i/2,-o/2,d,20,-90,0),{x:i/2+d,y:-d},...st(i/2+2*d,-d,d,20,-180,-270),...st(i/2+2*d,d,d,20,-90,-180),{x:i/2+d,y:o/2},...st(i/2,o/2,d,20,0,90)],m=[{x:-i/2,y:-o/2-d},{x:i/2,y:-o/2-d},...st(i/2,-o/2,d,20,-90,0),{x:i/2+d,y:-d},...st(i/2+2*d,-d,d,20,-180,-270),...st(i/2+2*d,d,d,20,-90,-180),{x:i/2+d,y:o/2},...st(i/2,o/2,d,20,0,90),{x:i/2,y:o/2+d},{x:-i/2,y:o/2+d}],x=c.A.svg(s),w=A(e,{fill:"none"});"handDrawn"!==e.look&&(w.roughness=0,w.fillStyle="solid");const b=p(u).replace("Z",""),S=x.path(b,w),$=p(m),k=x.path($,{...w}),v=s.insert("g",":first-child");return v.insert((()=>k),":first-child").attr("stroke-opacity",0),v.insert((()=>S),":first-child"),v.attr("class","text"),f&&"handDrawn"!==e.look&&v.selectAll("path").attr("style",f),n&&"handDrawn"!==e.look&&v.selectAll("path").attr("style",n),v.attr("transform",`translate(${-d}, 0)`),r.attr("transform",`translate(${-i/2+(e.padding??0)/2-(l.x-(l.left??0))},${-o/2+(e.padding??0)/2-(l.y-(l.top??0))})`),g(e,v),e.intersect=function(t){return F.polygon(e,m,t)},s}function rt(t,e,a,n=100,s=0,l=180){const r=[],i=s*Math.PI/180,o=(l*Math.PI/180-i)/(n-1);for(let c=0;c<n;c++){const n=i+c*o,s=t+a*Math.cos(n),l=e+a*Math.sin(n);r.push({x:-s,y:-l})}return r}async function it(t,e){const{labelStyles:a,nodeStyles:n}=D(e);e.labelStyle=a;const{shapeSvg:s,bbox:l,label:r}=await h(t,e,y(e)),i=l.width+(e.padding??0),o=l.height+(e.padding??0),d=Math.max(5,.1*o),{cssStyles:f}=e,u=[...rt(i/2,-o/2,d,30,-90,0),{x:-i/2-d,y:d},...rt(i/2+2*d,-d,d,20,-180,-270),...rt(i/2+2*d,d,d,20,-90,-180),{x:-i/2-d,y:-o/2},...rt(i/2,o/2,d,20,0,90)],m=[...rt(-i/2+d+d/2,-o/2,d,20,-90,-180),{x:i/2-d/2,y:d},...rt(-i/2-d/2,-d,d,20,0,90),...rt(-i/2-d/2,d,d,20,-90,0),{x:i/2-d/2,y:-d},...rt(-i/2+d+d/2,o/2,d,30,-180,-270)],x=[{x:i/2,y:-o/2-d},{x:-i/2,y:-o/2-d},...rt(i/2,-o/2,d,20,-90,0),{x:-i/2-d,y:-d},...rt(i/2+2*d,-d,d,20,-180,-270),...rt(i/2+2*d,d,d,20,-90,-180),{x:-i/2-d,y:o/2},...rt(i/2,o/2,d,20,0,90),{x:-i/2,y:o/2+d},{x:i/2-d-d/2,y:o/2+d},...rt(-i/2+d+d/2,-o/2,d,20,-90,-180),{x:i/2-d/2,y:d},...rt(-i/2-d/2,-d,d,20,0,90),...rt(-i/2-d/2,d,d,20,-90,0),{x:i/2-d/2,y:-d},...rt(-i/2+d+d/2,o/2,d,30,-180,-270)],w=c.A.svg(s),b=A(e,{fill:"none"});"handDrawn"!==e.look&&(b.roughness=0,b.fillStyle="solid");const S=p(u).replace("Z",""),$=w.path(S,b),k=p(m).replace("Z",""),v=w.path(k,b),M=p(x),B=w.path(M,{...b}),K=s.insert("g",":first-child");return K.insert((()=>B),":first-child").attr("stroke-opacity",0),K.insert((()=>$),":first-child"),K.insert((()=>v),":first-child"),K.attr("class","text"),f&&"handDrawn"!==e.look&&K.selectAll("path").attr("style",f),n&&"handDrawn"!==e.look&&K.selectAll("path").attr("style",n),K.attr("transform",`translate(${d-d/4}, 0)`),r.attr("transform",`translate(${-i/2+(e.padding??0)/2-(l.x-(l.left??0))},${-o/2+(e.padding??0)/2-(l.y-(l.top??0))})`),g(e,K),e.intersect=function(t){return F.polygon(e,x,t)},s}async function ot(t,e){const{labelStyles:a,nodeStyles:n}=D(e);e.labelStyle=a;const{shapeSvg:s,bbox:l}=await h(t,e,y(e)),r=Math.max(80,1.25*(l.width+2*(e.padding??0)),e?.width??0),i=Math.max(20,l.height+2*(e.padding??0),e?.height??0),o=i/2,{cssStyles:d}=e,f=c.A.svg(s),m=A(e,{});"handDrawn"!==e.look&&(m.roughness=0,m.fillStyle="solid");const x=r-o,w=i/4,b=[{x:x,y:0},{x:w,y:0},{x:0,y:i/2},{x:w,y:i},{x:x,y:i},...u(-x,-i/2,o,50,270,90)],S=p(b),$=f.path(S,m),k=s.insert((()=>$),":first-child");return k.attr("class","basic label-container"),d&&"handDrawn"!==e.look&&k.selectChildren("path").attr("style",d),n&&"handDrawn"!==e.look&&k.selectChildren("path").attr("style",n),k.attr("transform",`translate(${-r/2}, ${-i/2})`),g(e,k),e.intersect=function(t){return F.polygon(e,b,t)},s}(0,i.K2)(Z,"anchor"),(0,i.K2)(X,"generateArcPoints"),(0,i.K2)(Y,"bowTieRect"),(0,i.K2)(G,"insertPolygonShape"),(0,i.K2)(U,"card"),(0,i.K2)(J,"choice"),(0,i.K2)(Q,"circle"),(0,i.K2)(tt,"createLine"),(0,i.K2)(et,"crossedCircle"),(0,i.K2)(at,"generateCirclePoints"),(0,i.K2)(nt,"curlyBraceLeft"),(0,i.K2)(st,"generateCirclePoints"),(0,i.K2)(lt,"curlyBraceRight"),(0,i.K2)(rt,"generateCirclePoints"),(0,i.K2)(it,"curlyBraces"),(0,i.K2)(ot,"curvedTrapezoid");var ct=(0,i.K2)(((t,e,a,n,s,l)=>[`M${t},${e+l}`,`a${s},${l} 0,0,0 ${a},0`,`a${s},${l} 0,0,0 ${-a},0`,`l0,${n}`,`a${s},${l} 0,0,0 ${a},0`,"l0,"+-n].join(" ")),"createCylinderPathD"),ht=(0,i.K2)(((t,e,a,n,s,l)=>[`M${t},${e+l}`,`M${t+a},${e+l}`,`a${s},${l} 0,0,0 ${-a},0`,`l0,${n}`,`a${s},${l} 0,0,0 ${a},0`,"l0,"+-n].join(" ")),"createOuterCylinderPathD"),dt=(0,i.K2)(((t,e,a,n,s,l)=>[`M${t-a/2},${-n/2}`,`a${s},${l} 0,0,0 ${a},0`].join(" ")),"createInnerCylinderPathD");async function gt(t,e){const{labelStyles:a,nodeStyles:n}=D(e);e.labelStyle=a;const{shapeSvg:s,bbox:l,label:i}=await h(t,e,y(e)),o=Math.max(l.width+e.padding,e.width??0),d=o/2,p=d/(2.5+o/50),f=Math.max(l.height+p+e.padding,e.height??0);let u;const{cssStyles:m}=e;if("handDrawn"===e.look){const t=c.A.svg(s),a=ht(0,0,o,f,d,p),n=dt(0,p,o,f,d,p),l=t.path(a,A(e,{})),r=t.path(n,A(e,{fill:"none"}));u=s.insert((()=>r),":first-child"),u=s.insert((()=>l),":first-child"),u.attr("class","basic label-container"),m&&u.attr("style",m)}else{const t=ct(0,0,o,f,d,p);u=s.insert("path",":first-child").attr("d",t).attr("class","basic label-container").attr("style",(0,r.KL)(m)).attr("style",n)}return u.attr("label-offset-y",p),u.attr("transform",`translate(${-o/2}, ${-(f/2+p)})`),g(e,u),i.attr("transform",`translate(${-l.width/2-(l.x-(l.left??0))}, ${-l.height/2+(e.padding??0)/1.5-(l.y-(l.top??0))})`),e.intersect=function(t){const a=F.rect(e,t),n=a.x-(e.x??0);if(0!=d&&(Math.abs(n)<(e.width??0)/2||Math.abs(n)==(e.width??0)/2&&Math.abs(a.y-(e.y??0))>(e.height??0)/2-p)){let s=p*p*(1-n*n/(d*d));s>0&&(s=Math.sqrt(s)),s=p-s,t.y-(e.y??0)>0&&(s=-s),a.y+=s}return a},s}async function yt(t,e){const{labelStyles:a,nodeStyles:n}=D(e);e.labelStyle=a;const{shapeSvg:s,bbox:l,label:r}=await h(t,e,y(e)),i=l.width+e.padding,o=l.height+e.padding,d=.2*o,p=-i/2,f=-o/2-d/2,{cssStyles:u}=e,m=c.A.svg(s),x=A(e,{});"handDrawn"!==e.look&&(x.roughness=0,x.fillStyle="solid");const w=[{x:p,y:f+d},{x:-p,y:f+d},{x:-p,y:-f},{x:p,y:-f},{x:p,y:f},{x:-p,y:f},{x:-p,y:f+d}],b=m.polygon(w.map((t=>[t.x,t.y])),x),S=s.insert((()=>b),":first-child");return S.attr("class","basic label-container"),u&&"handDrawn"!==e.look&&S.selectAll("path").attr("style",u),n&&"handDrawn"!==e.look&&S.selectAll("path").attr("style",n),r.attr("transform",`translate(${p+(e.padding??0)/2-(l.x-(l.left??0))}, ${f+d+(e.padding??0)/2-(l.y-(l.top??0))})`),g(e,S),e.intersect=function(t){return F.rect(e,t)},s}async function pt(t,e){const{labelStyles:a,nodeStyles:n}=D(e);e.labelStyle=a;const{shapeSvg:s,bbox:l,halfPadding:o}=await h(t,e,y(e)),d=l.width/2+o+5,p=l.width/2+o;let f;const{cssStyles:u}=e;if("handDrawn"===e.look){const t=c.A.svg(s),a=A(e,{roughness:.2,strokeWidth:2.5}),n=A(e,{roughness:.2,strokeWidth:1.5}),l=t.circle(0,0,2*d,a),i=t.circle(0,0,2*p,n);f=s.insert("g",":first-child"),f.attr("class",(0,r.KL)(e.cssClasses)).attr("style",(0,r.KL)(u)),f.node()?.appendChild(l),f.node()?.appendChild(i)}else{f=s.insert("g",":first-child");const t=f.insert("circle",":first-child"),e=f.insert("circle");f.attr("class","basic label-container").attr("style",n),t.attr("class","outer-circle").attr("style",n).attr("r",d).attr("cx",0).attr("cy",0),e.attr("class","inner-circle").attr("style",n).attr("r",p).attr("cx",0).attr("cy",0)}return g(e,f),e.intersect=function(t){return i.Rm.info("DoubleCircle intersect",e,d,t),F.circle(e,d,t)},s}function ft(t,e,{config:{themeVariables:a}}){const{labelStyles:n,nodeStyles:s}=D(e);e.label="",e.labelStyle=n;const l=t.insert("g").attr("class",y(e)).attr("id",e.domId??e.id),{cssStyles:r}=e,o=c.A.svg(l),{nodeBorder:h}=a,d=A(e,{fillStyle:"solid"});"handDrawn"!==e.look&&(d.roughness=0);const p=o.circle(0,0,14,d),f=l.insert((()=>p),":first-child");return f.selectAll("path").attr("style",`fill: ${h} !important;`),r&&r.length>0&&"handDrawn"!==e.look&&f.selectAll("path").attr("style",r),s&&"handDrawn"!==e.look&&f.selectAll("path").attr("style",s),g(e,f),e.intersect=function(t){i.Rm.info("filledCircle intersect",e,{radius:7,point:t});return F.circle(e,7,t)},l}async function ut(t,e){const{labelStyles:a,nodeStyles:n}=D(e);e.labelStyle=a;const{shapeSvg:s,bbox:l,label:r}=await h(t,e,y(e)),o=l.width+(e.padding??0),d=o+l.height,f=o+l.height,u=[{x:0,y:-d},{x:f,y:-d},{x:f/2,y:0}],{cssStyles:m}=e,x=c.A.svg(s),w=A(e,{});"handDrawn"!==e.look&&(w.roughness=0,w.fillStyle="solid");const b=p(u),S=x.path(b,w),$=s.insert((()=>S),":first-child").attr("transform",`translate(${-d/2}, ${d/2})`);return m&&"handDrawn"!==e.look&&$.selectChildren("path").attr("style",m),n&&"handDrawn"!==e.look&&$.selectChildren("path").attr("style",n),e.width=o,e.height=d,g(e,$),r.attr("transform",`translate(${-l.width/2-(l.x-(l.left??0))}, ${-d/2+(e.padding??0)/2+(l.y-(l.top??0))})`),e.intersect=function(t){return i.Rm.info("Triangle intersect",e,u,t),F.polygon(e,u,t)},s}function mt(t,e,{dir:a,config:{state:n,themeVariables:s}}){const{nodeStyles:l}=D(e);e.label="";const r=t.insert("g").attr("class",y(e)).attr("id",e.domId??e.id),{cssStyles:i}=e;let o=Math.max(70,e?.width??0),h=Math.max(10,e?.height??0);"LR"===a&&(o=Math.max(10,e?.width??0),h=Math.max(70,e?.height??0));const d=-1*o/2,p=-1*h/2,f=c.A.svg(r),u=A(e,{stroke:s.lineColor,fill:s.lineColor});"handDrawn"!==e.look&&(u.roughness=0,u.fillStyle="solid");const m=f.rectangle(d,p,o,h,u),x=r.insert((()=>m),":first-child");i&&"handDrawn"!==e.look&&x.selectAll("path").attr("style",i),l&&"handDrawn"!==e.look&&x.selectAll("path").attr("style",l),g(e,x);const w=n?.padding??0;return e.width&&e.height&&(e.width+=w/2||0,e.height+=w/2||0),e.intersect=function(t){return F.rect(e,t)},r}async function xt(t,e){const{labelStyles:a,nodeStyles:n}=D(e);e.labelStyle=a;const{shapeSvg:s,bbox:l}=await h(t,e,y(e)),r=Math.max(80,l.width+2*(e.padding??0),e?.width??0),o=Math.max(50,l.height+2*(e.padding??0),e?.height??0),d=o/2,{cssStyles:f}=e,m=c.A.svg(s),x=A(e,{});"handDrawn"!==e.look&&(x.roughness=0,x.fillStyle="solid");const w=[{x:-r/2,y:-o/2},{x:r/2-d,y:-o/2},...u(-r/2+d,0,d,50,90,270),{x:r/2-d,y:o/2},{x:-r/2,y:o/2}],b=p(w),S=m.path(b,x),$=s.insert((()=>S),":first-child");return $.attr("class","basic label-container"),f&&"handDrawn"!==e.look&&$.selectChildren("path").attr("style",f),n&&"handDrawn"!==e.look&&$.selectChildren("path").attr("style",n),g(e,$),e.intersect=function(t){i.Rm.info("Pill intersect",e,{radius:d,point:t});return F.polygon(e,w,t)},s}(0,i.K2)(gt,"cylinder"),(0,i.K2)(yt,"dividedRectangle"),(0,i.K2)(pt,"doublecircle"),(0,i.K2)(ft,"filledCircle"),(0,i.K2)(ut,"flippedTriangle"),(0,i.K2)(mt,"forkJoin"),(0,i.K2)(xt,"halfRoundedRectangle");var wt=(0,i.K2)(((t,e,a,n,s)=>[`M${t+s},${e}`,`L${t+a-s},${e}`,`L${t+a},${e-n/2}`,`L${t+a-s},${e-n}`,`L${t+s},${e-n}`,`L${t},${e-n/2}`,"Z"].join(" ")),"createHexagonPathD");async function bt(t,e){const{labelStyles:a,nodeStyles:n}=D(e);e.labelStyle=a;const{shapeSvg:s,bbox:l}=await h(t,e,y(e)),r=l.height+e.padding,i=r/4,o=l.width+2*i+e.padding,d=[{x:i,y:0},{x:o-i,y:0},{x:o,y:-r/2},{x:o-i,y:-r},{x:i,y:-r},{x:0,y:-r/2}];let p;const{cssStyles:f}=e;if("handDrawn"===e.look){const t=c.A.svg(s),a=A(e,{}),n=wt(0,0,o,r,i),l=t.path(n,a);p=s.insert((()=>l),":first-child").attr("transform",`translate(${-o/2}, ${r/2})`),f&&p.attr("style",f)}else p=G(s,o,r,d);return n&&p.attr("style",n),e.width=o,e.height=r,g(e,p),e.intersect=function(t){return F.polygon(e,d,t)},s}async function St(t,e){const{labelStyles:a,nodeStyles:n}=D(e);e.label="",e.labelStyle=a;const{shapeSvg:s}=await h(t,e,y(e)),l=Math.max(30,e?.width??0),r=Math.max(30,e?.height??0),{cssStyles:o}=e,d=c.A.svg(s),f=A(e,{});"handDrawn"!==e.look&&(f.roughness=0,f.fillStyle="solid");const u=[{x:0,y:0},{x:l,y:0},{x:0,y:r},{x:l,y:r}],m=p(u),x=d.path(m,f),w=s.insert((()=>x),":first-child");return w.attr("class","basic label-container"),o&&"handDrawn"!==e.look&&w.selectChildren("path").attr("style",o),n&&"handDrawn"!==e.look&&w.selectChildren("path").attr("style",n),w.attr("transform",`translate(${-l/2}, ${-r/2})`),g(e,w),e.intersect=function(t){i.Rm.info("Pill intersect",e,{points:u});return F.polygon(e,u,t)},s}async function $t(t,e,{config:{themeVariables:a,flowchart:n}}){const{labelStyles:l}=D(e);e.labelStyle=l;const r=e.assetHeight??48,o=e.assetWidth??48,d=Math.max(r,o),y=n?.wrappingWidth;e.width=Math.max(d,y??0);const{shapeSvg:p,bbox:f,label:u}=await h(t,e,"icon-shape default"),m="t"===e.pos,x=d,w=d,{nodeBorder:b}=a,{stylesMap:S}=k(e),$=-w/2,v=-x/2,M=e.label?8:0,B=c.A.svg(p),K=A(e,{stroke:"none",fill:"none"});"handDrawn"!==e.look&&(K.roughness=0,K.fillStyle="solid");const C=B.rectangle($,v,w,x,K),L=Math.max(w,f.width),N=x+f.height+M,R=B.rectangle(-L/2,-N/2,L,N,{...K,fill:"transparent",stroke:"none"}),P=p.insert((()=>C),":first-child"),T=p.insert((()=>R));if(e.icon){const t=p.append("g");t.html(`<g>${await(0,s.WY)(e.icon,{height:d,width:d,fallbackPrefix:""})}</g>`);const a=t.node().getBBox(),n=a.width,l=a.height,r=a.x,i=a.y;t.attr("transform",`translate(${-n/2-r},${m?f.height/2+M/2-l/2-i:-f.height/2-M/2-l/2-i})`),t.attr("style",`color: ${S.get("stroke")??b};`)}return u.attr("transform",`translate(${-f.width/2-(f.x-(f.left??0))},${m?-N/2:N/2-f.height})`),P.attr("transform",`translate(0,${m?f.height/2+M/2:-f.height/2-M/2})`),g(e,T),e.intersect=function(t){if(i.Rm.info("iconSquare intersect",e,t),!e.label)return F.rect(e,t);const a=e.x??0,n=e.y??0,s=e.height??0;let l=[];l=m?[{x:a-f.width/2,y:n-s/2},{x:a+f.width/2,y:n-s/2},{x:a+f.width/2,y:n-s/2+f.height+M},{x:a+w/2,y:n-s/2+f.height+M},{x:a+w/2,y:n+s/2},{x:a-w/2,y:n+s/2},{x:a-w/2,y:n-s/2+f.height+M},{x:a-f.width/2,y:n-s/2+f.height+M}]:[{x:a-w/2,y:n-s/2},{x:a+w/2,y:n-s/2},{x:a+w/2,y:n-s/2+x},{x:a+f.width/2,y:n-s/2+x},{x:a+f.width/2/2,y:n+s/2},{x:a-f.width/2,y:n+s/2},{x:a-f.width/2,y:n-s/2+x},{x:a-w/2,y:n-s/2+x}];return F.polygon(e,l,t)},p}async function kt(t,e,{config:{themeVariables:a,flowchart:n}}){const{labelStyles:l}=D(e);e.labelStyle=l;const r=e.assetHeight??48,o=e.assetWidth??48,d=Math.max(r,o),y=n?.wrappingWidth;e.width=Math.max(d,y??0);const{shapeSvg:p,bbox:f,label:u}=await h(t,e,"icon-shape default"),m=e.label?8:0,x="t"===e.pos,{nodeBorder:w,mainBkg:b}=a,{stylesMap:S}=k(e),$=c.A.svg(p),v=A(e,{});"handDrawn"!==e.look&&(v.roughness=0,v.fillStyle="solid");const M=S.get("fill");v.stroke=M??b;const B=p.append("g");e.icon&&B.html(`<g>${await(0,s.WY)(e.icon,{height:d,width:d,fallbackPrefix:""})}</g>`);const K=B.node().getBBox(),C=K.width,L=K.height,N=K.x,R=K.y,P=Math.max(C,L)*Math.SQRT2+40,T=$.circle(0,0,P,v),I=Math.max(P,f.width),j=P+f.height+m,W=$.rectangle(-I/2,-j/2,I,j,{...v,fill:"transparent",stroke:"none"}),_=p.insert((()=>T),":first-child"),E=p.insert((()=>W));return B.attr("transform",`translate(${-C/2-N},${x?f.height/2+m/2-L/2-R:-f.height/2-m/2-L/2-R})`),B.attr("style",`color: ${S.get("stroke")??w};`),u.attr("transform",`translate(${-f.width/2-(f.x-(f.left??0))},${x?-j/2:j/2-f.height})`),_.attr("transform",`translate(0,${x?f.height/2+m/2:-f.height/2-m/2})`),g(e,E),e.intersect=function(t){i.Rm.info("iconSquare intersect",e,t);return F.rect(e,t)},p}async function vt(t,e,{config:{themeVariables:a,flowchart:n}}){const{labelStyles:l}=D(e);e.labelStyle=l;const r=e.assetHeight??48,o=e.assetWidth??48,d=Math.max(r,o),y=n?.wrappingWidth;e.width=Math.max(d,y??0);const{shapeSvg:p,bbox:f,halfPadding:u,label:m}=await h(t,e,"icon-shape default"),x="t"===e.pos,w=d+2*u,b=d+2*u,{nodeBorder:$,mainBkg:v}=a,{stylesMap:M}=k(e),B=-b/2,K=-w/2,C=e.label?8:0,L=c.A.svg(p),N=A(e,{});"handDrawn"!==e.look&&(N.roughness=0,N.fillStyle="solid");const R=M.get("fill");N.stroke=R??v;const P=L.path(S(B,K,b,w,5),N),T=Math.max(b,f.width),I=w+f.height+C,j=L.rectangle(-T/2,-I/2,T,I,{...N,fill:"transparent",stroke:"none"}),W=p.insert((()=>P),":first-child").attr("class","icon-shape2"),_=p.insert((()=>j));if(e.icon){const t=p.append("g");t.html(`<g>${await(0,s.WY)(e.icon,{height:d,width:d,fallbackPrefix:""})}</g>`);const a=t.node().getBBox(),n=a.width,l=a.height,r=a.x,i=a.y;t.attr("transform",`translate(${-n/2-r},${x?f.height/2+C/2-l/2-i:-f.height/2-C/2-l/2-i})`),t.attr("style",`color: ${M.get("stroke")??$};`)}return m.attr("transform",`translate(${-f.width/2-(f.x-(f.left??0))},${x?-I/2:I/2-f.height})`),W.attr("transform",`translate(0,${x?f.height/2+C/2:-f.height/2-C/2})`),g(e,_),e.intersect=function(t){if(i.Rm.info("iconSquare intersect",e,t),!e.label)return F.rect(e,t);const a=e.x??0,n=e.y??0,s=e.height??0;let l=[];l=x?[{x:a-f.width/2,y:n-s/2},{x:a+f.width/2,y:n-s/2},{x:a+f.width/2,y:n-s/2+f.height+C},{x:a+b/2,y:n-s/2+f.height+C},{x:a+b/2,y:n+s/2},{x:a-b/2,y:n+s/2},{x:a-b/2,y:n-s/2+f.height+C},{x:a-f.width/2,y:n-s/2+f.height+C}]:[{x:a-b/2,y:n-s/2},{x:a+b/2,y:n-s/2},{x:a+b/2,y:n-s/2+w},{x:a+f.width/2,y:n-s/2+w},{x:a+f.width/2/2,y:n+s/2},{x:a-f.width/2,y:n+s/2},{x:a-f.width/2,y:n-s/2+w},{x:a-b/2,y:n-s/2+w}];return F.polygon(e,l,t)},p}async function Mt(t,e,{config:{themeVariables:a,flowchart:n}}){const{labelStyles:l}=D(e);e.labelStyle=l;const r=e.assetHeight??48,o=e.assetWidth??48,d=Math.max(r,o),y=n?.wrappingWidth;e.width=Math.max(d,y??0);const{shapeSvg:p,bbox:f,halfPadding:u,label:m}=await h(t,e,"icon-shape default"),x="t"===e.pos,w=d+2*u,b=d+2*u,{nodeBorder:$,mainBkg:v}=a,{stylesMap:M}=k(e),B=-b/2,K=-w/2,C=e.label?8:0,L=c.A.svg(p),N=A(e,{});"handDrawn"!==e.look&&(N.roughness=0,N.fillStyle="solid");const R=M.get("fill");N.stroke=R??v;const P=L.path(S(B,K,b,w,.1),N),T=Math.max(b,f.width),I=w+f.height+C,j=L.rectangle(-T/2,-I/2,T,I,{...N,fill:"transparent",stroke:"none"}),W=p.insert((()=>P),":first-child"),_=p.insert((()=>j));if(e.icon){const t=p.append("g");t.html(`<g>${await(0,s.WY)(e.icon,{height:d,width:d,fallbackPrefix:""})}</g>`);const a=t.node().getBBox(),n=a.width,l=a.height,r=a.x,i=a.y;t.attr("transform",`translate(${-n/2-r},${x?f.height/2+C/2-l/2-i:-f.height/2-C/2-l/2-i})`),t.attr("style",`color: ${M.get("stroke")??$};`)}return m.attr("transform",`translate(${-f.width/2-(f.x-(f.left??0))},${x?-I/2:I/2-f.height})`),W.attr("transform",`translate(0,${x?f.height/2+C/2:-f.height/2-C/2})`),g(e,_),e.intersect=function(t){if(i.Rm.info("iconSquare intersect",e,t),!e.label)return F.rect(e,t);const a=e.x??0,n=e.y??0,s=e.height??0;let l=[];l=x?[{x:a-f.width/2,y:n-s/2},{x:a+f.width/2,y:n-s/2},{x:a+f.width/2,y:n-s/2+f.height+C},{x:a+b/2,y:n-s/2+f.height+C},{x:a+b/2,y:n+s/2},{x:a-b/2,y:n+s/2},{x:a-b/2,y:n-s/2+f.height+C},{x:a-f.width/2,y:n-s/2+f.height+C}]:[{x:a-b/2,y:n-s/2},{x:a+b/2,y:n-s/2},{x:a+b/2,y:n-s/2+w},{x:a+f.width/2,y:n-s/2+w},{x:a+f.width/2/2,y:n+s/2},{x:a-f.width/2,y:n+s/2},{x:a-f.width/2,y:n-s/2+w},{x:a-b/2,y:n-s/2+w}];return F.polygon(e,l,t)},p}async function Dt(t,e,{config:{flowchart:a}}){const n=new Image;n.src=e?.img??"",await n.decode();const s=Number(n.naturalWidth.toString().replace("px","")),l=Number(n.naturalHeight.toString().replace("px",""));e.imageAspectRatio=s/l;const{labelStyles:r}=D(e);e.labelStyle=r;const o=a?.wrappingWidth;e.defaultWidth=a?.wrappingWidth;const d=Math.max(e.label?o??0:0,e?.assetWidth??s),y="on"===e.constraint&&e?.assetHeight?e.assetHeight*e.imageAspectRatio:d,p="on"===e.constraint?y/e.imageAspectRatio:e?.assetHeight??l;e.width=Math.max(y,o??0);const{shapeSvg:f,bbox:u,label:m}=await h(t,e,"image-shape default"),x="t"===e.pos,w=-y/2,b=-p/2,S=e.label?8:0,$=c.A.svg(f),k=A(e,{});"handDrawn"!==e.look&&(k.roughness=0,k.fillStyle="solid");const v=$.rectangle(w,b,y,p,k),M=Math.max(y,u.width),B=p+u.height+S,K=$.rectangle(-M/2,-B/2,M,B,{...k,fill:"none",stroke:"none"}),C=f.insert((()=>v),":first-child"),L=f.insert((()=>K));if(e.img){const t=f.append("image");t.attr("href",e.img),t.attr("width",y),t.attr("height",p),t.attr("preserveAspectRatio","none"),t.attr("transform",`translate(${-y/2},${x?B/2-p:-B/2})`)}return m.attr("transform",`translate(${-u.width/2-(u.x-(u.left??0))},${x?-p/2-u.height/2-S/2:p/2-u.height/2+S/2})`),C.attr("transform",`translate(0,${x?u.height/2+S/2:-u.height/2-S/2})`),g(e,L),e.intersect=function(t){if(i.Rm.info("iconSquare intersect",e,t),!e.label)return F.rect(e,t);const a=e.x??0,n=e.y??0,s=e.height??0;let l=[];l=x?[{x:a-u.width/2,y:n-s/2},{x:a+u.width/2,y:n-s/2},{x:a+u.width/2,y:n-s/2+u.height+S},{x:a+y/2,y:n-s/2+u.height+S},{x:a+y/2,y:n+s/2},{x:a-y/2,y:n+s/2},{x:a-y/2,y:n-s/2+u.height+S},{x:a-u.width/2,y:n-s/2+u.height+S}]:[{x:a-y/2,y:n-s/2},{x:a+y/2,y:n-s/2},{x:a+y/2,y:n-s/2+p},{x:a+u.width/2,y:n-s/2+p},{x:a+u.width/2/2,y:n+s/2},{x:a-u.width/2,y:n+s/2},{x:a-u.width/2,y:n-s/2+p},{x:a-y/2,y:n-s/2+p}];return F.polygon(e,l,t)},f}async function At(t,e){const{labelStyles:a,nodeStyles:n}=D(e);e.labelStyle=a;const{shapeSvg:s,bbox:l}=await h(t,e,y(e)),r=Math.max(l.width+2*(e.padding??0),e?.width??0),i=Math.max(l.height+2*(e.padding??0),e?.height??0),o=[{x:0,y:0},{x:r,y:0},{x:r+3*i/6,y:-i},{x:-3*i/6,y:-i}];let d;const{cssStyles:f}=e;if("handDrawn"===e.look){const t=c.A.svg(s),a=A(e,{}),n=p(o),l=t.path(n,a);d=s.insert((()=>l),":first-child").attr("transform",`translate(${-r/2}, ${i/2})`),f&&d.attr("style",f)}else d=G(s,r,i,o);return n&&d.attr("style",n),e.width=r,e.height=i,g(e,d),e.intersect=function(t){return F.polygon(e,o,t)},s}async function Bt(t,e,a){const{labelStyles:n,nodeStyles:s}=D(e);e.labelStyle=n;const{shapeSvg:l,bbox:i}=await h(t,e,y(e)),o=Math.max(i.width+2*a.labelPaddingX,e?.width||0),d=Math.max(i.height+2*a.labelPaddingY,e?.height||0),p=-o/2,f=-d/2;let u,{rx:m,ry:x}=e;const{cssStyles:w}=e;if(a?.rx&&a.ry&&(m=a.rx,x=a.ry),"handDrawn"===e.look){const t=c.A.svg(l),a=A(e,{}),n=m||x?t.path(S(p,f,o,d,m||0),a):t.rectangle(p,f,o,d,a);u=l.insert((()=>n),":first-child"),u.attr("class","basic label-container").attr("style",(0,r.KL)(w))}else u=l.insert("rect",":first-child"),u.attr("class","basic label-container").attr("style",s).attr("rx",(0,r.KL)(m)).attr("ry",(0,r.KL)(x)).attr("x",p).attr("y",f).attr("width",o).attr("height",d);return g(e,u),e.intersect=function(t){return F.rect(e,t)},l}async function Kt(t,e){const{shapeSvg:a,bbox:n,label:s}=await h(t,e,"label"),l=a.insert("rect",":first-child");return l.attr("width",.1).attr("height",.1),a.attr("class","label edgeLabel"),s.attr("transform",`translate(${-n.width/2-(n.x-(n.left??0))}, ${-n.height/2-(n.y-(n.top??0))})`),g(e,l),e.intersect=function(t){return F.rect(e,t)},a}async function Ct(t,e){const{labelStyles:a,nodeStyles:n}=D(e);e.labelStyle=a;const{shapeSvg:s,bbox:l}=await h(t,e,y(e)),r=Math.max(l.width+(e.padding??0),e?.width??0),i=Math.max(l.height+(e.padding??0),e?.height??0),o=[{x:0,y:0},{x:r+3*i/6,y:0},{x:r,y:-i},{x:-3*i/6,y:-i}];let d;const{cssStyles:f}=e;if("handDrawn"===e.look){const t=c.A.svg(s),a=A(e,{}),n=p(o),l=t.path(n,a);d=s.insert((()=>l),":first-child").attr("transform",`translate(${-r/2}, ${i/2})`),f&&d.attr("style",f)}else d=G(s,r,i,o);return n&&d.attr("style",n),e.width=r,e.height=i,g(e,d),e.intersect=function(t){return F.polygon(e,o,t)},s}async function Lt(t,e){const{labelStyles:a,nodeStyles:n}=D(e);e.labelStyle=a;const{shapeSvg:s,bbox:l}=await h(t,e,y(e)),r=Math.max(l.width+(e.padding??0),e?.width??0),i=Math.max(l.height+(e.padding??0),e?.height??0),o=[{x:-3*i/6,y:0},{x:r,y:0},{x:r+3*i/6,y:-i},{x:0,y:-i}];let d;const{cssStyles:f}=e;if("handDrawn"===e.look){const t=c.A.svg(s),a=A(e,{}),n=p(o),l=t.path(n,a);d=s.insert((()=>l),":first-child").attr("transform",`translate(${-r/2}, ${i/2})`),f&&d.attr("style",f)}else d=G(s,r,i,o);return n&&d.attr("style",n),e.width=r,e.height=i,g(e,d),e.intersect=function(t){return F.polygon(e,o,t)},s}function Nt(t,e){const{labelStyles:a,nodeStyles:n}=D(e);e.label="",e.labelStyle=a;const s=t.insert("g").attr("class",y(e)).attr("id",e.domId??e.id),{cssStyles:l}=e,r=Math.max(35,e?.width??0),o=Math.max(35,e?.height??0),h=[{x:r,y:0},{x:0,y:o+3.5},{x:r-14,y:o+3.5},{x:0,y:2*o},{x:r,y:o-3.5},{x:14,y:o-3.5}],d=c.A.svg(s),f=A(e,{});"handDrawn"!==e.look&&(f.roughness=0,f.fillStyle="solid");const u=p(h),m=d.path(u,f),x=s.insert((()=>m),":first-child");return l&&"handDrawn"!==e.look&&x.selectAll("path").attr("style",l),n&&"handDrawn"!==e.look&&x.selectAll("path").attr("style",n),x.attr("transform",`translate(-${r/2},${-o})`),g(e,x),e.intersect=function(t){i.Rm.info("lightningBolt intersect",e,t);return F.polygon(e,h,t)},s}(0,i.K2)(bt,"hexagon"),(0,i.K2)(St,"hourglass"),(0,i.K2)($t,"icon"),(0,i.K2)(kt,"iconCircle"),(0,i.K2)(vt,"iconRounded"),(0,i.K2)(Mt,"iconSquare"),(0,i.K2)(Dt,"imageSquare"),(0,i.K2)(At,"inv_trapezoid"),(0,i.K2)(Bt,"drawRect"),(0,i.K2)(Kt,"labelRect"),(0,i.K2)(Ct,"lean_left"),(0,i.K2)(Lt,"lean_right"),(0,i.K2)(Nt,"lightningBolt");var Rt=(0,i.K2)(((t,e,a,n,s,l,r)=>[`M${t},${e+l}`,`a${s},${l} 0,0,0 ${a},0`,`a${s},${l} 0,0,0 ${-a},0`,`l0,${n}`,`a${s},${l} 0,0,0 ${a},0`,"l0,"+-n,`M${t},${e+l+r}`,`a${s},${l} 0,0,0 ${a},0`].join(" ")),"createCylinderPathD"),Pt=(0,i.K2)(((t,e,a,n,s,l,r)=>[`M${t},${e+l}`,`M${t+a},${e+l}`,`a${s},${l} 0,0,0 ${-a},0`,`l0,${n}`,`a${s},${l} 0,0,0 ${a},0`,"l0,"+-n,`M${t},${e+l+r}`,`a${s},${l} 0,0,0 ${a},0`].join(" ")),"createOuterCylinderPathD"),Tt=(0,i.K2)(((t,e,a,n,s,l)=>[`M${t-a/2},${-n/2}`,`a${s},${l} 0,0,0 ${a},0`].join(" ")),"createInnerCylinderPathD");async function It(t,e){const{labelStyles:a,nodeStyles:n}=D(e);e.labelStyle=a;const{shapeSvg:s,bbox:l,label:i}=await h(t,e,y(e)),o=Math.max(l.width+(e.padding??0),e.width??0),d=o/2,p=d/(2.5+o/50),f=Math.max(l.height+p+(e.padding??0),e.height??0),u=.1*f;let m;const{cssStyles:x}=e;if("handDrawn"===e.look){const t=c.A.svg(s),a=Pt(0,0,o,f,d,p,u),n=Tt(0,p,o,f,d,p),l=A(e,{}),r=t.path(a,l),i=t.path(n,l);s.insert((()=>i),":first-child").attr("class","line"),m=s.insert((()=>r),":first-child"),m.attr("class","basic label-container"),x&&m.attr("style",x)}else{const t=Rt(0,0,o,f,d,p,u);m=s.insert("path",":first-child").attr("d",t).attr("class","basic label-container").attr("style",(0,r.KL)(x)).attr("style",n)}return m.attr("label-offset-y",p),m.attr("transform",`translate(${-o/2}, ${-(f/2+p)})`),g(e,m),i.attr("transform",`translate(${-l.width/2-(l.x-(l.left??0))}, ${-l.height/2+p-(l.y-(l.top??0))})`),e.intersect=function(t){const a=F.rect(e,t),n=a.x-(e.x??0);if(0!=d&&(Math.abs(n)<(e.width??0)/2||Math.abs(n)==(e.width??0)/2&&Math.abs(a.y-(e.y??0))>(e.height??0)/2-p)){let s=p*p*(1-n*n/(d*d));s>0&&(s=Math.sqrt(s)),s=p-s,t.y-(e.y??0)>0&&(s=-s),a.y+=s}return a},s}async function jt(t,e){const{labelStyles:a,nodeStyles:n}=D(e);e.labelStyle=a;const{shapeSvg:s,bbox:l,label:r}=await h(t,e,y(e)),i=Math.max(l.width+2*(e.padding??0),e?.width??0),o=Math.max(l.height+2*(e.padding??0),e?.height??0),d=o/4,p=o+d,{cssStyles:u}=e,m=c.A.svg(s),x=A(e,{});"handDrawn"!==e.look&&(x.roughness=0,x.fillStyle="solid");const w=[{x:-i/2-i/2*.1,y:-p/2},{x:-i/2-i/2*.1,y:p/2},...f(-i/2-i/2*.1,p/2,i/2+i/2*.1,p/2,d,.8),{x:i/2+i/2*.1,y:-p/2},{x:-i/2-i/2*.1,y:-p/2},{x:-i/2,y:-p/2},{x:-i/2,y:p/2*1.1},{x:-i/2,y:-p/2}],b=m.polygon(w.map((t=>[t.x,t.y])),x),S=s.insert((()=>b),":first-child");return S.attr("class","basic label-container"),u&&"handDrawn"!==e.look&&S.selectAll("path").attr("style",u),n&&"handDrawn"!==e.look&&S.selectAll("path").attr("style",n),S.attr("transform",`translate(0,${-d/2})`),r.attr("transform",`translate(${-i/2+(e.padding??0)+i/2*.1/2-(l.x-(l.left??0))},${-o/2+(e.padding??0)-d/2-(l.y-(l.top??0))})`),g(e,S),e.intersect=function(t){return F.polygon(e,w,t)},s}async function Wt(t,e){const{labelStyles:a,nodeStyles:n}=D(e);e.labelStyle=a;const{shapeSvg:s,bbox:l,label:r}=await h(t,e,y(e)),i=Math.max(l.width+2*(e.padding??0),e?.width??0),o=Math.max(l.height+2*(e.padding??0),e?.height??0),d=-i/2,f=-o/2,{cssStyles:u}=e,m=c.A.svg(s),x=A(e,{}),w=[{x:d-5,y:f+5},{x:d-5,y:f+o+5},{x:d+i-5,y:f+o+5},{x:d+i-5,y:f+o},{x:d+i,y:f+o},{x:d+i,y:f+o-5},{x:d+i+5,y:f+o-5},{x:d+i+5,y:f-5},{x:d+5,y:f-5},{x:d+5,y:f},{x:d,y:f},{x:d,y:f+5}],b=[{x:d,y:f+5},{x:d+i-5,y:f+5},{x:d+i-5,y:f+o},{x:d+i,y:f+o},{x:d+i,y:f},{x:d,y:f}];"handDrawn"!==e.look&&(x.roughness=0,x.fillStyle="solid");const S=p(w),$=m.path(S,x),k=p(b),v=m.path(k,{...x,fill:"none"}),M=s.insert((()=>v),":first-child");return M.insert((()=>$),":first-child"),M.attr("class","basic label-container"),u&&"handDrawn"!==e.look&&M.selectAll("path").attr("style",u),n&&"handDrawn"!==e.look&&M.selectAll("path").attr("style",n),r.attr("transform",`translate(${-l.width/2-5-(l.x-(l.left??0))}, ${-l.height/2+5-(l.y-(l.top??0))})`),g(e,M),e.intersect=function(t){return F.polygon(e,w,t)},s}async function _t(t,e){const{labelStyles:a,nodeStyles:n}=D(e);e.labelStyle=a;const{shapeSvg:s,bbox:l,label:r}=await h(t,e,y(e)),i=Math.max(l.width+2*(e.padding??0),e?.width??0),o=Math.max(l.height+2*(e.padding??0),e?.height??0),d=o/4,u=o+d,m=-i/2,x=-u/2,{cssStyles:w}=e,b=f(m-5,x+u+5,m+i-5,x+u+5,d,.8),S=b?.[b.length-1],$=[{x:m-5,y:x+5},{x:m-5,y:x+u+5},...b,{x:m+i-5,y:S.y-5},{x:m+i,y:S.y-5},{x:m+i,y:S.y-10},{x:m+i+5,y:S.y-10},{x:m+i+5,y:x-5},{x:m+5,y:x-5},{x:m+5,y:x},{x:m,y:x},{x:m,y:x+5}],k=[{x:m,y:x+5},{x:m+i-5,y:x+5},{x:m+i-5,y:S.y-5},{x:m+i,y:S.y-5},{x:m+i,y:x},{x:m,y:x}],v=c.A.svg(s),M=A(e,{});"handDrawn"!==e.look&&(M.roughness=0,M.fillStyle="solid");const B=p($),K=v.path(B,M),C=p(k),L=v.path(C,M),N=s.insert((()=>K),":first-child");return N.insert((()=>L)),N.attr("class","basic label-container"),w&&"handDrawn"!==e.look&&N.selectAll("path").attr("style",w),n&&"handDrawn"!==e.look&&N.selectAll("path").attr("style",n),N.attr("transform",`translate(0,${-d/2})`),r.attr("transform",`translate(${-l.width/2-5-(l.x-(l.left??0))}, ${-l.height/2+5-d/2-(l.y-(l.top??0))})`),g(e,N),e.intersect=function(t){return F.polygon(e,$,t)},s}async function Et(t,e,{config:{themeVariables:a}}){const{labelStyles:n,nodeStyles:s}=D(e);e.labelStyle=n;e.useHtmlLabels||!1!==(0,i.zj)().flowchart?.htmlLabels||(e.centerLabel=!0);const{shapeSvg:l,bbox:r}=await h(t,e,y(e)),o=Math.max(r.width+2*(e.padding??0),e?.width??0),d=Math.max(r.height+2*(e.padding??0),e?.height??0),p=-o/2,f=-d/2,{cssStyles:u}=e,m=c.A.svg(l),x=A(e,{fill:a.noteBkgColor,stroke:a.noteBorderColor});"handDrawn"!==e.look&&(x.roughness=0,x.fillStyle="solid");const w=m.rectangle(p,f,o,d,x),b=l.insert((()=>w),":first-child");return b.attr("class","basic label-container"),u&&"handDrawn"!==e.look&&b.selectAll("path").attr("style",u),s&&"handDrawn"!==e.look&&b.selectAll("path").attr("style",s),g(e,b),e.intersect=function(t){return F.rect(e,t)},l}(0,i.K2)(It,"linedCylinder"),(0,i.K2)(jt,"linedWaveEdgedRect"),(0,i.K2)(Wt,"multiRect"),(0,i.K2)(_t,"multiWaveEdgedRectangle"),(0,i.K2)(Et,"note");var Ht=(0,i.K2)(((t,e,a)=>[`M${t+a/2},${e}`,`L${t+a},${e-a/2}`,`L${t+a/2},${e-a}`,`L${t},${e-a/2}`,"Z"].join(" ")),"createDecisionBoxPathD");async function zt(t,e){const{labelStyles:a,nodeStyles:n}=D(e);e.labelStyle=a;const{shapeSvg:s,bbox:l}=await h(t,e,y(e)),r=l.width+e.padding+(l.height+e.padding),o=[{x:r/2,y:0},{x:r,y:-r/2},{x:r/2,y:-r},{x:0,y:-r/2}];let d;const{cssStyles:p}=e;if("handDrawn"===e.look){const t=c.A.svg(s),a=A(e,{}),n=Ht(0,0,r),l=t.path(n,a);d=s.insert((()=>l),":first-child").attr("transform",`translate(${-r/2}, ${r/2})`),p&&d.attr("style",p)}else d=G(s,r,r,o);return n&&d.attr("style",n),g(e,d),e.intersect=function(t){return i.Rm.debug("APA12 Intersect called SPLIT\npoint:",t,"\nnode:\n",e,"\nres:",F.polygon(e,o,t)),F.polygon(e,o,t)},s}async function qt(t,e){const{labelStyles:a,nodeStyles:n}=D(e);e.labelStyle=a;const{shapeSvg:s,bbox:l,label:r}=await h(t,e,y(e)),i=-Math.max(l.width+(e.padding??0),e?.width??0)/2,o=-Math.max(l.height+(e.padding??0),e?.height??0)/2,d=o/2,f=[{x:i+d,y:o},{x:i,y:0},{x:i+d,y:-o},{x:-i,y:-o},{x:-i,y:o}],{cssStyles:u}=e,m=c.A.svg(s),x=A(e,{});"handDrawn"!==e.look&&(x.roughness=0,x.fillStyle="solid");const w=p(f),b=m.path(w,x),S=s.insert((()=>b),":first-child");return S.attr("class","basic label-container"),u&&"handDrawn"!==e.look&&S.selectAll("path").attr("style",u),n&&"handDrawn"!==e.look&&S.selectAll("path").attr("style",n),S.attr("transform",`translate(${-d/2},0)`),r.attr("transform",`translate(${-d/2-l.width/2-(l.x-(l.left??0))}, ${-l.height/2-(l.y-(l.top??0))})`),g(e,S),e.intersect=function(t){return F.polygon(e,f,t)},s}async function Vt(t,e){const{labelStyles:a,nodeStyles:n}=D(e);let s;e.labelStyle=a,s=e.cssClasses?"node "+e.cssClasses:"node default";const l=t.insert("g").attr("class",s).attr("id",e.domId||e.id),r=l.insert("g"),h=l.insert("g").attr("class","label").attr("style",n),d=e.description,y=e.label,p=h.node().appendChild(await b(y,e.labelStyle,!0,!0));let f={width:0,height:0};if((0,i._3)((0,i.D7)()?.flowchart?.htmlLabels)){const t=p.children[0],e=(0,o.Ltv)(p);f=t.getBoundingClientRect(),e.attr("width",f.width),e.attr("height",f.height)}i.Rm.info("Text 2",d);const u=d||[],m=p.getBBox(),x=h.node().appendChild(await b(u.join?u.join("<br/>"):u,e.labelStyle,!0,!0)),w=x.children[0],$=(0,o.Ltv)(x);f=w.getBoundingClientRect(),$.attr("width",f.width),$.attr("height",f.height);const k=(e.padding||0)/2;(0,o.Ltv)(x).attr("transform","translate( "+(f.width>m.width?0:(m.width-f.width)/2)+", "+(m.height+k+5)+")"),(0,o.Ltv)(p).attr("transform","translate( "+(f.width<m.width?0:-(m.width-f.width)/2)+", 0)"),f=h.node().getBBox(),h.attr("transform","translate("+-f.width/2+", "+(-f.height/2-k+3)+")");const v=f.width+(e.padding||0),M=f.height+(e.padding||0),B=-f.width/2-k,K=-f.height/2-k;let C,L;if("handDrawn"===e.look){const t=c.A.svg(l),a=A(e,{}),n=t.path(S(B,K,v,M,e.rx||0),a),s=t.line(-f.width/2-k,-f.height/2-k+m.height+k,f.width/2+k,-f.height/2-k+m.height+k,a);L=l.insert((()=>(i.Rm.debug("Rough node insert CXC",n),s)),":first-child"),C=l.insert((()=>(i.Rm.debug("Rough node insert CXC",n),n)),":first-child")}else C=r.insert("rect",":first-child"),L=r.insert("line"),C.attr("class","outer title-state").attr("style",n).attr("x",-f.width/2-k).attr("y",-f.height/2-k).attr("width",f.width+(e.padding||0)).attr("height",f.height+(e.padding||0)),L.attr("class","divider").attr("x1",-f.width/2-k).attr("x2",f.width/2+k).attr("y1",-f.height/2-k+m.height+k).attr("y2",-f.height/2-k+m.height+k);return g(e,C),e.intersect=function(t){return F.rect(e,t)},l}async function Ot(t,e){return Bt(t,e,{rx:5,ry:5,classes:"",labelPaddingX:1*(e?.padding||0),labelPaddingY:1*(e?.padding||0)})}async function Ft(t,e){const{labelStyles:a,nodeStyles:n}=D(e);e.labelStyle=a;const{shapeSvg:s,bbox:l,label:i}=await h(t,e,y(e)),o=e?.padding??0,d=Math.max(l.width+2*(e.padding??0),e?.width??0),p=Math.max(l.height+2*(e.padding??0),e?.height??0),f=-l.width/2-o,u=-l.height/2-o,{cssStyles:m}=e,x=c.A.svg(s),w=A(e,{});"handDrawn"!==e.look&&(w.roughness=0,w.fillStyle="solid");const b=[{x:f,y:u},{x:f+d+8,y:u},{x:f+d+8,y:u+p},{x:f-8,y:u+p},{x:f-8,y:u},{x:f,y:u},{x:f,y:u+p}],S=x.polygon(b.map((t=>[t.x,t.y])),w),$=s.insert((()=>S),":first-child");return $.attr("class","basic label-container").attr("style",(0,r.KL)(m)),n&&"handDrawn"!==e.look&&$.selectAll("path").attr("style",n),m&&"handDrawn"!==e.look&&$.selectAll("path").attr("style",n),i.attr("transform",`translate(${-d/2+4+(e.padding??0)-(l.x-(l.left??0))},${-p/2+(e.padding??0)-(l.y-(l.top??0))})`),g(e,$),e.intersect=function(t){return F.rect(e,t)},s}async function Zt(t,e){const{labelStyles:a,nodeStyles:n}=D(e);e.labelStyle=a;const{shapeSvg:s,bbox:l,label:r}=await h(t,e,y(e)),i=Math.max(l.width+2*(e.padding??0),e?.width??0),o=Math.max(l.height+2*(e.padding??0),e?.height??0),d=-i/2,f=-o/2,{cssStyles:u}=e,m=c.A.svg(s),x=A(e,{});"handDrawn"!==e.look&&(x.roughness=0,x.fillStyle="solid");const w=[{x:d,y:f},{x:d,y:f+o},{x:d+i,y:f+o},{x:d+i,y:f-o/2}],b=p(w),S=m.path(b,x),$=s.insert((()=>S),":first-child");return $.attr("class","basic label-container"),u&&"handDrawn"!==e.look&&$.selectChildren("path").attr("style",u),n&&"handDrawn"!==e.look&&$.selectChildren("path").attr("style",n),$.attr("transform",`translate(0, ${o/4})`),r.attr("transform",`translate(${-i/2+(e.padding??0)-(l.x-(l.left??0))}, ${-o/4+(e.padding??0)-(l.y-(l.top??0))})`),g(e,$),e.intersect=function(t){return F.polygon(e,w,t)},s}async function Xt(t,e){return Bt(t,e,{rx:0,ry:0,classes:"",labelPaddingX:2*(e?.padding||0),labelPaddingY:1*(e?.padding||0)})}async function Yt(t,e){const{labelStyles:a,nodeStyles:n}=D(e);e.labelStyle=a;const{shapeSvg:s,bbox:l}=await h(t,e,y(e)),i=l.height+e.padding,o=l.width+i/4+e.padding;let d;const{cssStyles:p}=e;if("handDrawn"===e.look){const t=c.A.svg(s),a=A(e,{}),n=S(-o/2,-i/2,o,i,i/2),l=t.path(n,a);d=s.insert((()=>l),":first-child"),d.attr("class","basic label-container").attr("style",(0,r.KL)(p))}else d=s.insert("rect",":first-child"),d.attr("class","basic label-container").attr("style",n).attr("rx",i/2).attr("ry",i/2).attr("x",-o/2).attr("y",-i/2).attr("width",o).attr("height",i);return g(e,d),e.intersect=function(t){return F.rect(e,t)},s}async function Gt(t,e){return Bt(t,e,{rx:5,ry:5,classes:"flowchart-node"})}function Ut(t,e,{config:{themeVariables:a}}){const{labelStyles:n,nodeStyles:s}=D(e);e.labelStyle=n;const{cssStyles:l}=e,{lineColor:r,stateBorder:i,nodeBorder:o}=a,h=t.insert("g").attr("class","node default").attr("id",e.domId||e.id),d=c.A.svg(h),y=A(e,{});"handDrawn"!==e.look&&(y.roughness=0,y.fillStyle="solid");const p=d.circle(0,0,14,{...y,stroke:r,strokeWidth:2}),f=i??o,u=d.circle(0,0,5,{...y,fill:f,stroke:f,strokeWidth:2,fillStyle:"solid"}),m=h.insert((()=>p),":first-child");return m.insert((()=>u)),l&&m.selectAll("path").attr("style",l),s&&m.selectAll("path").attr("style",s),g(e,m),e.intersect=function(t){return F.circle(e,7,t)},h}function Jt(t,e,{config:{themeVariables:a}}){const{lineColor:n}=a,s=t.insert("g").attr("class","node default").attr("id",e.domId||e.id);let l;if("handDrawn"===e.look){const t=c.A.svg(s).circle(0,0,14,$(n));l=s.insert((()=>t)),l.attr("class","state-start").attr("r",7).attr("width",14).attr("height",14)}else l=s.insert("circle",":first-child"),l.attr("class","state-start").attr("r",7).attr("width",14).attr("height",14);return g(e,l),e.intersect=function(t){return F.circle(e,7,t)},s}async function Qt(t,e){const{labelStyles:a,nodeStyles:n}=D(e);e.labelStyle=a;const{shapeSvg:s,bbox:l}=await h(t,e,y(e)),i=(e?.padding||0)/2,o=l.width+e.padding,d=l.height+e.padding,p=-l.width/2-i,f=-l.height/2-i,u=[{x:0,y:0},{x:o,y:0},{x:o,y:-d},{x:0,y:-d},{x:0,y:0},{x:-8,y:0},{x:o+8,y:0},{x:o+8,y:-d},{x:-8,y:-d},{x:-8,y:0}];if("handDrawn"===e.look){const t=c.A.svg(s),a=A(e,{}),n=t.rectangle(p-8,f,o+16,d,a),l=t.line(p,f,p,f+d,a),i=t.line(p+o,f,p+o,f+d,a);s.insert((()=>l),":first-child"),s.insert((()=>i),":first-child");const h=s.insert((()=>n),":first-child"),{cssStyles:y}=e;h.attr("class","basic label-container").attr("style",(0,r.KL)(y)),g(e,h)}else{const t=G(s,o,d,u);n&&t.attr("style",n),g(e,t)}return e.intersect=function(t){return F.polygon(e,u,t)},s}async function te(t,e){const{labelStyles:a,nodeStyles:n}=D(e);e.labelStyle=a;const{shapeSvg:s,bbox:l}=await h(t,e,y(e)),r=Math.max(l.width+2*(e.padding??0),e?.width??0),i=Math.max(l.height+2*(e.padding??0),e?.height??0),o=-r/2,d=-i/2,f=.2*i,u=.2*i,{cssStyles:m}=e,x=c.A.svg(s),w=A(e,{}),b=[{x:o-f/2,y:d},{x:o+r+f/2,y:d},{x:o+r+f/2,y:d+i},{x:o-f/2,y:d+i}],S=[{x:o+r-f/2,y:d+i},{x:o+r+f/2,y:d+i},{x:o+r+f/2,y:d+i-u}];"handDrawn"!==e.look&&(w.roughness=0,w.fillStyle="solid");const $=p(b),k=x.path($,w),v=p(S),M=x.path(v,{...w,fillStyle:"solid"}),B=s.insert((()=>M),":first-child");return B.insert((()=>k),":first-child"),B.attr("class","basic label-container"),m&&"handDrawn"!==e.look&&B.selectAll("path").attr("style",m),n&&"handDrawn"!==e.look&&B.selectAll("path").attr("style",n),g(e,B),e.intersect=function(t){return F.polygon(e,b,t)},s}async function ee(t,e){const{labelStyles:a,nodeStyles:n}=D(e);e.labelStyle=a;const{shapeSvg:s,bbox:l,label:r}=await h(t,e,y(e)),i=Math.max(l.width+2*(e.padding??0),e?.width??0),o=Math.max(l.height+2*(e.padding??0),e?.height??0),d=o/4,u=.2*i,m=.2*o,x=o+d,{cssStyles:w}=e,b=c.A.svg(s),S=A(e,{});"handDrawn"!==e.look&&(S.roughness=0,S.fillStyle="solid");const $=[{x:-i/2-i/2*.1,y:x/2},...f(-i/2-i/2*.1,x/2,i/2+i/2*.1,x/2,d,.8),{x:i/2+i/2*.1,y:-x/2},{x:-i/2-i/2*.1,y:-x/2}],k=-i/2+i/2*.1,v=-x/2-.4*m,M=[{x:k+i-u,y:1.4*(v+o)},{x:k+i,y:v+o-m},{x:k+i,y:.9*(v+o)},...f(k+i,1.3*(v+o),k+i-u,1.5*(v+o),.03*-o,.5)],B=p($),K=b.path(B,S),C=p(M),L=b.path(C,{...S,fillStyle:"solid"}),N=s.insert((()=>L),":first-child");return N.insert((()=>K),":first-child"),N.attr("class","basic label-container"),w&&"handDrawn"!==e.look&&N.selectAll("path").attr("style",w),n&&"handDrawn"!==e.look&&N.selectAll("path").attr("style",n),N.attr("transform",`translate(0,${-d/2})`),r.attr("transform",`translate(${-i/2+(e.padding??0)-(l.x-(l.left??0))},${-o/2+(e.padding??0)-d/2-(l.y-(l.top??0))})`),g(e,N),e.intersect=function(t){return F.polygon(e,$,t)},s}async function ae(t,e){const{labelStyles:a,nodeStyles:n}=D(e);e.labelStyle=a;const{shapeSvg:s,bbox:l}=await h(t,e,y(e)),r=Math.max(l.width+e.padding,e?.width||0),i=Math.max(l.height+e.padding,e?.height||0),o=-r/2,c=-i/2,d=s.insert("rect",":first-child");return d.attr("class","text").attr("style",n).attr("rx",0).attr("ry",0).attr("x",o).attr("y",c).attr("width",r).attr("height",i),g(e,d),e.intersect=function(t){return F.rect(e,t)},s}(0,i.K2)(zt,"question"),(0,i.K2)(qt,"rect_left_inv_arrow"),(0,i.K2)(Vt,"rectWithTitle"),(0,i.K2)(Ot,"roundedRect"),(0,i.K2)(Ft,"shadedProcess"),(0,i.K2)(Zt,"slopedRect"),(0,i.K2)(Xt,"squareRect"),(0,i.K2)(Yt,"stadium"),(0,i.K2)(Gt,"state"),(0,i.K2)(Ut,"stateEnd"),(0,i.K2)(Jt,"stateStart"),(0,i.K2)(Qt,"subroutine"),(0,i.K2)(te,"taggedRect"),(0,i.K2)(ee,"taggedWaveEdgedRectangle"),(0,i.K2)(ae,"text");var ne=(0,i.K2)(((t,e,a,n,s,l)=>`M${t},${e}\n    a${s},${l} 0,0,1 0,${-n}\n    l${a},0\n    a${s},${l} 0,0,1 0,${n}\n    M${a},${-n}\n    a${s},${l} 0,0,0 0,${n}\n    l${-a},0`),"createCylinderPathD"),se=(0,i.K2)(((t,e,a,n,s,l)=>[`M${t},${e}`,`M${t+a},${e}`,`a${s},${l} 0,0,0 0,${-n}`,`l${-a},0`,`a${s},${l} 0,0,0 0,${n}`,`l${a},0`].join(" ")),"createOuterCylinderPathD"),le=(0,i.K2)(((t,e,a,n,s,l)=>[`M${t+a/2},${-n/2}`,`a${s},${l} 0,0,0 0,${n}`].join(" ")),"createInnerCylinderPathD");async function re(t,e){const{labelStyles:a,nodeStyles:n}=D(e);e.labelStyle=a;const{shapeSvg:s,bbox:l,label:i,halfPadding:o}=await h(t,e,y(e)),d="neo"===e.look?2*o:o,p=l.height+d,f=p/2,u=f/(2.5+p/50),m=l.width+u+d,{cssStyles:x}=e;let w;if("handDrawn"===e.look){const t=c.A.svg(s),a=se(0,0,m,p,u,f),n=le(0,0,m,p,u,f),l=t.path(a,A(e,{})),r=t.path(n,A(e,{fill:"none"}));w=s.insert((()=>r),":first-child"),w=s.insert((()=>l),":first-child"),w.attr("class","basic label-container"),x&&w.attr("style",x)}else{const t=ne(0,0,m,p,u,f);w=s.insert("path",":first-child").attr("d",t).attr("class","basic label-container").attr("style",(0,r.KL)(x)).attr("style",n),w.attr("class","basic label-container"),x&&w.selectAll("path").attr("style",x),n&&w.selectAll("path").attr("style",n)}return w.attr("label-offset-x",u),w.attr("transform",`translate(${-m/2}, ${p/2} )`),i.attr("transform",`translate(${-l.width/2-u-(l.x-(l.left??0))}, ${-l.height/2-(l.y-(l.top??0))})`),g(e,w),e.intersect=function(t){const a=F.rect(e,t),n=a.y-(e.y??0);if(0!=f&&(Math.abs(n)<(e.height??0)/2||Math.abs(n)==(e.height??0)/2&&Math.abs(a.x-(e.x??0))>(e.width??0)/2-u)){let s=u*u*(1-n*n/(f*f));0!=s&&(s=Math.sqrt(Math.abs(s))),s=u-s,t.x-(e.x??0)>0&&(s=-s),a.x+=s}return a},s}async function ie(t,e){const{labelStyles:a,nodeStyles:n}=D(e);e.labelStyle=a;const{shapeSvg:s,bbox:l}=await h(t,e,y(e)),r=l.width+e.padding,i=l.height+e.padding,o=[{x:-3*i/6,y:0},{x:r+3*i/6,y:0},{x:r,y:-i},{x:0,y:-i}];let d;const{cssStyles:f}=e;if("handDrawn"===e.look){const t=c.A.svg(s),a=A(e,{}),n=p(o),l=t.path(n,a);d=s.insert((()=>l),":first-child").attr("transform",`translate(${-r/2}, ${i/2})`),f&&d.attr("style",f)}else d=G(s,r,i,o);return n&&d.attr("style",n),e.width=r,e.height=i,g(e,d),e.intersect=function(t){return F.polygon(e,o,t)},s}async function oe(t,e){const{labelStyles:a,nodeStyles:n}=D(e);e.labelStyle=a;const{shapeSvg:s,bbox:l}=await h(t,e,y(e)),r=Math.max(60,l.width+2*(e.padding??0),e?.width??0),i=Math.max(20,l.height+2*(e.padding??0),e?.height??0),{cssStyles:o}=e,d=c.A.svg(s),f=A(e,{});"handDrawn"!==e.look&&(f.roughness=0,f.fillStyle="solid");const u=[{x:-r/2*.8,y:-i/2},{x:r/2*.8,y:-i/2},{x:r/2,y:-i/2*.6},{x:r/2,y:i/2},{x:-r/2,y:i/2},{x:-r/2,y:-i/2*.6}],m=p(u),x=d.path(m,f),w=s.insert((()=>x),":first-child");return w.attr("class","basic label-container"),o&&"handDrawn"!==e.look&&w.selectChildren("path").attr("style",o),n&&"handDrawn"!==e.look&&w.selectChildren("path").attr("style",n),g(e,w),e.intersect=function(t){return F.polygon(e,u,t)},s}async function ce(t,e){const{labelStyles:a,nodeStyles:n}=D(e);e.labelStyle=a;const{shapeSvg:s,bbox:l,label:r}=await h(t,e,y(e)),o=(0,i._3)((0,i.D7)().flowchart?.htmlLabels),d=l.width+(e.padding??0),f=d+l.height,u=d+l.height,m=[{x:0,y:0},{x:u,y:0},{x:u/2,y:-f}],{cssStyles:x}=e,w=c.A.svg(s),b=A(e,{});"handDrawn"!==e.look&&(b.roughness=0,b.fillStyle="solid");const S=p(m),$=w.path(S,b),k=s.insert((()=>$),":first-child").attr("transform",`translate(${-f/2}, ${f/2})`);return x&&"handDrawn"!==e.look&&k.selectChildren("path").attr("style",x),n&&"handDrawn"!==e.look&&k.selectChildren("path").attr("style",n),e.width=d,e.height=f,g(e,k),r.attr("transform",`translate(${-l.width/2-(l.x-(l.left??0))}, ${f/2-(l.height+(e.padding??0)/(o?2:1)-(l.y-(l.top??0)))})`),e.intersect=function(t){return i.Rm.info("Triangle intersect",e,m,t),F.polygon(e,m,t)},s}async function he(t,e){const{labelStyles:a,nodeStyles:n}=D(e);e.labelStyle=a;const{shapeSvg:s,bbox:l,label:r}=await h(t,e,y(e)),i=Math.max(l.width+2*(e.padding??0),e?.width??0),o=Math.max(l.height+2*(e.padding??0),e?.height??0),d=o/8,u=o+d,{cssStyles:m}=e,x=70-i,w=x>0?x/2:0,b=c.A.svg(s),S=A(e,{});"handDrawn"!==e.look&&(S.roughness=0,S.fillStyle="solid");const $=[{x:-i/2-w,y:u/2},...f(-i/2-w,u/2,i/2+w,u/2,d,.8),{x:i/2+w,y:-u/2},{x:-i/2-w,y:-u/2}],k=p($),v=b.path(k,S),M=s.insert((()=>v),":first-child");return M.attr("class","basic label-container"),m&&"handDrawn"!==e.look&&M.selectAll("path").attr("style",m),n&&"handDrawn"!==e.look&&M.selectAll("path").attr("style",n),M.attr("transform",`translate(0,${-d/2})`),r.attr("transform",`translate(${-i/2+(e.padding??0)-(l.x-(l.left??0))},${-o/2+(e.padding??0)-d-(l.y-(l.top??0))})`),g(e,M),e.intersect=function(t){return F.polygon(e,$,t)},s}async function de(t,e){const{labelStyles:a,nodeStyles:n}=D(e);e.labelStyle=a;const{shapeSvg:s,bbox:l}=await h(t,e,y(e)),r=Math.max(l.width+2*(e.padding??0),e?.width??0),i=Math.max(l.height+2*(e.padding??0),e?.height??0),o=r/i;let d=r,u=i;d>u*o?u=d/o:d=u*o,d=Math.max(d,100),u=Math.max(u,50);const m=Math.min(.2*u,u/4),x=u+2*m,{cssStyles:w}=e,b=c.A.svg(s),S=A(e,{});"handDrawn"!==e.look&&(S.roughness=0,S.fillStyle="solid");const $=[{x:-d/2,y:x/2},...f(-d/2,x/2,d/2,x/2,m,1),{x:d/2,y:-x/2},...f(d/2,-x/2,-d/2,-x/2,m,-1)],k=p($),v=b.path(k,S),M=s.insert((()=>v),":first-child");return M.attr("class","basic label-container"),w&&"handDrawn"!==e.look&&M.selectAll("path").attr("style",w),n&&"handDrawn"!==e.look&&M.selectAll("path").attr("style",n),g(e,M),e.intersect=function(t){return F.polygon(e,$,t)},s}async function ge(t,e){const{labelStyles:a,nodeStyles:n}=D(e);e.labelStyle=a;const{shapeSvg:s,bbox:l,label:r}=await h(t,e,y(e)),i=Math.max(l.width+2*(e.padding??0),e?.width??0),o=Math.max(l.height+2*(e.padding??0),e?.height??0),d=-i/2,p=-o/2,{cssStyles:f}=e,u=c.A.svg(s),m=A(e,{}),x=[{x:d-5,y:p-5},{x:d-5,y:p+o},{x:d+i,y:p+o},{x:d+i,y:p-5}],w=`M${d-5},${p-5} L${d+i},${p-5} L${d+i},${p+o} L${d-5},${p+o} L${d-5},${p-5}\n                M${d-5},${p} L${d+i},${p}\n                M${d},${p-5} L${d},${p+o}`;"handDrawn"!==e.look&&(m.roughness=0,m.fillStyle="solid");const b=u.path(w,m),S=s.insert((()=>b),":first-child");return S.attr("transform","translate(2.5, 2.5)"),S.attr("class","basic label-container"),f&&"handDrawn"!==e.look&&S.selectAll("path").attr("style",f),n&&"handDrawn"!==e.look&&S.selectAll("path").attr("style",n),r.attr("transform",`translate(${-l.width/2+2.5-(l.x-(l.left??0))}, ${-l.height/2+2.5-(l.y-(l.top??0))})`),g(e,S),e.intersect=function(t){return F.polygon(e,x,t)},s}async function ye(t,e){const a=e;if(a.alias&&(e.label=a.alias),"handDrawn"===e.look){const{themeVariables:a}=(0,i.zj)(),{background:n}=a,s={...e,id:e.id+"-background",look:"default",cssStyles:["stroke: none",`fill: ${n}`]};await ye(t,s)}const n=(0,i.zj)();e.useHtmlLabels=n.htmlLabels;let s=n.er?.diagramPadding??10,l=n.er?.entityPadding??6;const{cssStyles:h}=e,{labelStyles:d}=D(e);if(0===a.attributes.length&&e.label){const a={rx:0,ry:0,labelPaddingX:s,labelPaddingY:1.5*s,classes:""};(0,r.Un)(e.label,n)+2*a.labelPaddingX<n.er.minEntityWidth&&(e.width=n.er.minEntityWidth);const l=await Bt(t,e,a);if(!(0,i._3)(n.htmlLabels)){const t=l.select("text"),e=t.node()?.getBBox();t.attr("transform",`translate(${-e.width/2}, 0)`)}return l}n.htmlLabels||(s*=1.25,l*=1.25);let p=y(e);p||(p="node default");const f=t.insert("g").attr("class",p).attr("id",e.domId||e.id),u=await pe(f,e.label??"",n,0,0,["name"],d);u.height+=l;let m=0;const x=[];let w=0,b=0,S=0,$=0,k=!0,v=!0;for(const r of a.attributes){const t=await pe(f,r.type,n,0,m,["attribute-type"],d);w=Math.max(w,t.width+s);const e=await pe(f,r.name,n,0,m,["attribute-name"],d);b=Math.max(b,e.width+s);const a=await pe(f,r.keys.join(),n,0,m,["attribute-keys"],d);S=Math.max(S,a.width+s);const i=await pe(f,r.comment,n,0,m,["attribute-comment"],d);$=Math.max($,i.width+s),m+=Math.max(t.height,e.height,a.height,i.height)+l,x.push(m)}x.pop();let M=4;S<=s&&(k=!1,S=0,M--),$<=s&&(v=!1,$=0,M--);const B=f.node().getBBox();if(u.width+2*s-(w+b+S+$)>0){const t=u.width+2*s-(w+b+S+$);w+=t/M,b+=t/M,S>0&&(S+=t/M),$>0&&($+=t/M)}const K=w+b+S+$,C=c.A.svg(f),L=A(e,{});"handDrawn"!==e.look&&(L.roughness=0,L.fillStyle="solid");const N=Math.max(B.width+2*s,e?.width||0,K),R=Math.max(B.height+(x[0]||m)+l,e?.height||0),P=-N/2,T=-R/2;f.selectAll("g:not(:first-child)").each(((t,e,a)=>{const n=(0,o.Ltv)(a[e]),r=n.attr("transform");let i=0,c=0;if(r){const t=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(r);t&&(i=parseFloat(t[1]),c=parseFloat(t[2]),n.attr("class").includes("attribute-name")?i+=w:n.attr("class").includes("attribute-keys")?i+=w+b:n.attr("class").includes("attribute-comment")&&(i+=w+b+S))}n.attr("transform",`translate(${P+s/2+i}, ${c+T+u.height+l/2})`)})),f.select(".name").attr("transform","translate("+-u.width/2+", "+(T+l/2)+")");const I=C.rectangle(P,T,N,R,L),j=f.insert((()=>I),":first-child").attr("style",h.join("")),{themeVariables:W}=(0,i.zj)(),{rowEven:_,rowOdd:E,nodeBorder:H}=W;x.push(0);for(const[r,i]of x.entries()){if(0===r&&x.length>1)continue;const t=r%2==0&&0!==i,e=C.rectangle(P,u.height+T+i,N,u.height,{...L,fill:t?_:E,stroke:H});f.insert((()=>e),"g.label").attr("style",h.join("")).attr("class","row-rect-"+(r%2==0?"even":"odd"))}let z=C.line(P,u.height+T,N+P,u.height+T,L);f.insert((()=>z)).attr("class","divider"),z=C.line(w+P,u.height+T,w+P,R+T,L),f.insert((()=>z)).attr("class","divider"),k&&(z=C.line(w+b+P,u.height+T,w+b+P,R+T,L),f.insert((()=>z)).attr("class","divider")),v&&(z=C.line(w+b+S+P,u.height+T,w+b+S+P,R+T,L),f.insert((()=>z)).attr("class","divider"));for(const r of x)z=C.line(P,u.height+T+r,N+P,u.height+T+r,L),f.insert((()=>z)).attr("class","divider");return g(e,j),e.intersect=function(t){return F.rect(e,t)},f}async function pe(t,e,a,n=0,s=0,c=[],h=""){const d=t.insert("g").attr("class",`label ${c.join(" ")}`).attr("transform",`translate(${n}, ${s})`).attr("style",h);e!==(0,i.QO)(e)&&(e=(e=(0,i.QO)(e)).replaceAll("<","&lt;").replaceAll(">","&gt;"));const g=d.node().appendChild(await(0,l.GZ)(d,e,{width:(0,r.Un)(e,a)+100,style:h,useHtmlLabels:a.htmlLabels},a));if(e.includes("&lt;")||e.includes("&gt;")){let t=g.children[0];for(t.textContent=t.textContent.replaceAll("&lt;","<").replaceAll("&gt;",">");t.childNodes[0];)t=t.childNodes[0],t.textContent=t.textContent.replaceAll("&lt;","<").replaceAll("&gt;",">")}let y=g.getBBox();if((0,i._3)(a.htmlLabels)){const t=g.children[0];t.style.textAlign="start";const e=(0,o.Ltv)(g);y=t.getBoundingClientRect(),e.attr("width",y.width),e.attr("height",y.height)}return y}async function fe(t,e,a,n,s=a.class.padding??12){const l=n?0:3,r=t.insert("g").attr("class",y(e)).attr("id",e.domId||e.id);let i=null,o=null,c=null,h=null,d=0,g=0,p=0;if(i=r.insert("g").attr("class","annotation-group text"),e.annotations.length>0){const t=e.annotations[0];await ue(i,{text:`«${t}»`},0);d=i.node().getBBox().height}o=r.insert("g").attr("class","label-group text"),await ue(o,e,0,["font-weight: bolder"]);const f=o.node().getBBox();g=f.height,c=r.insert("g").attr("class","members-group text");let u=0;for(const y of e.members){u+=await ue(c,y,u,[y.parseClassifier()])+l}p=c.node().getBBox().height,p<=0&&(p=s/2),h=r.insert("g").attr("class","methods-group text");let m=0;for(const y of e.methods){m+=await ue(h,y,m,[y.parseClassifier()])+l}let x=r.node().getBBox();if(null!==i){const t=i.node().getBBox();i.attr("transform",`translate(${-t.width/2})`)}return o.attr("transform",`translate(${-f.width/2}, ${d})`),x=r.node().getBBox(),c.attr("transform",`translate(0, ${d+g+2*s})`),x=r.node().getBBox(),h.attr("transform",`translate(0, ${d+g+(p?p+4*s:2*s)})`),x=r.node().getBBox(),{shapeSvg:r,bbox:x}}async function ue(t,e,a,n=[]){const s=t.insert("g").attr("class","label").attr("style",n.join("; ")),c=(0,i.zj)();let h="useHtmlLabels"in e?e.useHtmlLabels:(0,i._3)(c.htmlLabels)??!0,d="";d="text"in e?e.text:e.label,!h&&d.startsWith("\\")&&(d=d.substring(1)),(0,i.Wi)(d)&&(h=!0);const g=await(0,l.GZ)(s,(0,i.oB)((0,r.Sm)(d)),{width:(0,r.Un)(d,c)+50,classes:"markdown-node-label",useHtmlLabels:h},c);let y,p=1;if(h){const t=g.children[0],e=(0,o.Ltv)(g);p=t.innerHTML.split("<br>").length,t.innerHTML.includes("</math>")&&(p+=t.innerHTML.split("<mrow>").length-1);const a=t.getElementsByTagName("img");if(a){const t=""===d.replace(/<img[^>]*>/g,"").trim();await Promise.all([...a].map((e=>new Promise((a=>{function n(){if(e.style.display="flex",e.style.flexDirection="column",t){const t=c.fontSize?.toString()??window.getComputedStyle(document.body).fontSize,a=5,n=parseInt(t,10)*a+"px";e.style.minWidth=n,e.style.maxWidth=n}else e.style.width="100%";a(e)}(0,i.K2)(n,"setupImage"),setTimeout((()=>{e.complete&&n()})),e.addEventListener("error",n),e.addEventListener("load",n)})))))}y=t.getBoundingClientRect(),e.attr("width",y.width),e.attr("height",y.height)}else{n.includes("font-weight: bolder")&&(0,o.Ltv)(g).selectAll("tspan").attr("font-weight",""),p=g.children.length;const t=g.children[0];if(""===g.textContent||g.textContent.includes("&gt")){t.textContent=d[0]+d.substring(1).replaceAll("&gt;",">").replaceAll("&lt;","<").trim();" "===d[1]&&(t.textContent=t.textContent[0]+" "+t.textContent.substring(1))}"undefined"===t.textContent&&(t.textContent=""),y=g.getBBox()}return s.attr("transform","translate(0,"+(-y.height/(2*p)+a)+")"),y.height}async function me(t,e){const a=(0,i.D7)(),n=a.class.padding??12,s=n,l=e.useHtmlLabels??(0,i._3)(a.htmlLabels)??!0,r=e;r.annotations=r.annotations??[],r.members=r.members??[],r.methods=r.methods??[];const{shapeSvg:h,bbox:d}=await fe(t,e,a,l,s),{labelStyles:y,nodeStyles:p}=D(e);e.labelStyle=y,e.cssStyles=r.styles||"";const f=r.styles?.join(";")||p||"";e.cssStyles||(e.cssStyles=f.replaceAll("!important","").split(";"));const u=0===r.members.length&&0===r.methods.length&&!a.class?.hideEmptyMembersBox,m=c.A.svg(h),x=A(e,{});"handDrawn"!==e.look&&(x.roughness=0,x.fillStyle="solid");const w=d.width;let b=d.height;0===r.members.length&&0===r.methods.length?b+=s:r.members.length>0&&0===r.methods.length&&(b+=2*s);const S=-w/2,$=-b/2,k=m.rectangle(S-n,$-n-(u?n:0===r.members.length&&0===r.methods.length?-n/2:0),w+2*n,b+2*n+(u?2*n:0===r.members.length&&0===r.methods.length?-n:0),x),v=h.insert((()=>k),":first-child");v.attr("class","basic label-container");const M=v.node().getBBox();h.selectAll(".text").each(((t,e,a)=>{const s=(0,o.Ltv)(a[e]),i=s.attr("transform");let c=0;if(i){const t=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(i);t&&(c=parseFloat(t[2]))}let d=c+$+n-(u?n:0===r.members.length&&0===r.methods.length?-n/2:0);l||(d-=4);let g=S;(s.attr("class").includes("label-group")||s.attr("class").includes("annotation-group"))&&(g=-s.node()?.getBBox().width/2||0,h.selectAll("text").each((function(t,e,a){"middle"===window.getComputedStyle(a[e]).textAnchor&&(g=0)}))),s.attr("transform",`translate(${g}, ${d})`)}));const B=h.select(".annotation-group").node().getBBox().height-(u?n/2:0)||0,K=h.select(".label-group").node().getBBox().height-(u?n/2:0)||0,C=h.select(".members-group").node().getBBox().height-(u?n/2:0)||0;if(r.members.length>0||r.methods.length>0||u){const t=m.line(M.x,B+K+$+n,M.x+M.width,B+K+$+n,x);h.insert((()=>t)).attr("class","divider").attr("style",f)}if(u||r.members.length>0||r.methods.length>0){const t=m.line(M.x,B+K+C+$+2*s+n,M.x+M.width,B+K+C+$+n+2*s,x);h.insert((()=>t)).attr("class","divider").attr("style",f)}if("handDrawn"!==r.look&&h.selectAll("path").attr("style",f),v.select(":nth-child(2)").attr("style",f),h.selectAll(".divider").select("path").attr("style",f),e.labelStyle?h.selectAll("span").attr("style",e.labelStyle):h.selectAll("span").attr("style",f),!l){const t=RegExp(/color\s*:\s*([^;]*)/),e=t.exec(f);if(e){const t=e[0].replace("color","fill");h.selectAll("tspan").attr("style",t)}else if(y){const e=t.exec(y);if(e){const t=e[0].replace("color","fill");h.selectAll("tspan").attr("style",t)}}}return g(e,v),e.intersect=function(t){return F.rect(e,t)},h}async function xe(t,e){const{labelStyles:a,nodeStyles:n}=D(e);e.labelStyle=a;const s=e,l=e,r="verifyMethod"in e,i=y(e),h=t.insert("g").attr("class",i).attr("id",e.domId??e.id);let d;d=r?await we(h,`&lt;&lt;${s.type}&gt;&gt;`,0,e.labelStyle):await we(h,"&lt;&lt;Element&gt;&gt;",0,e.labelStyle);let p=d;const f=await we(h,s.name,p,e.labelStyle+"; font-weight: bold;");if(p+=f+20,r){p+=await we(h,""+(s.requirementId?`Id: ${s.requirementId}`:""),p,e.labelStyle);p+=await we(h,""+(s.text?`Text: ${s.text}`:""),p,e.labelStyle);p+=await we(h,""+(s.risk?`Risk: ${s.risk}`:""),p,e.labelStyle),await we(h,""+(s.verifyMethod?`Verification: ${s.verifyMethod}`:""),p,e.labelStyle)}else{p+=await we(h,""+(l.type?`Type: ${l.type}`:""),p,e.labelStyle),await we(h,""+(l.docRef?`Doc Ref: ${l.docRef}`:""),p,e.labelStyle)}const u=(h.node()?.getBBox().width??200)+20,m=(h.node()?.getBBox().height??200)+20,x=-u/2,w=-m/2,b=c.A.svg(h),S=A(e,{});"handDrawn"!==e.look&&(S.roughness=0,S.fillStyle="solid");const $=b.rectangle(x,w,u,m,S),k=h.insert((()=>$),":first-child");if(k.attr("class","basic label-container").attr("style",n),h.selectAll(".label").each(((t,e,a)=>{const n=(0,o.Ltv)(a[e]),s=n.attr("transform");let l=0,r=0;if(s){const t=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(s);t&&(l=parseFloat(t[1]),r=parseFloat(t[2]))}const i=r-m/2;let c=x+10;0!==e&&1!==e||(c=l),n.attr("transform",`translate(${c}, ${i+20})`)})),p>d+f+20){const t=b.line(x,w+d+f+20,x+u,w+d+f+20,S);h.insert((()=>t)).attr("style",n)}return g(e,k),e.intersect=function(t){return F.rect(e,t)},h}async function we(t,e,a,n=""){if(""===e)return 0;const s=t.insert("g").attr("class","label").attr("style",n),c=(0,i.D7)(),h=c.htmlLabels??!0,d=await(0,l.GZ)(s,(0,i.oB)((0,r.Sm)(e)),{width:(0,r.Un)(e,c)+50,classes:"markdown-node-label",useHtmlLabels:h,style:n},c);let g;if(h){const t=d.children[0],e=(0,o.Ltv)(d);g=t.getBoundingClientRect(),e.attr("width",g.width),e.attr("height",g.height)}else{const t=d.children[0];for(const e of t.children)e.textContent=e.textContent.replaceAll("&gt;",">").replaceAll("&lt;","<"),n&&e.setAttribute("style",n);g=d.getBBox(),g.height+=6}return s.attr("transform",`translate(${-g.width/2},${-g.height/2+a})`),g.height}(0,i.K2)(re,"tiltedCylinder"),(0,i.K2)(ie,"trapezoid"),(0,i.K2)(oe,"trapezoidalPentagon"),(0,i.K2)(ce,"triangle"),(0,i.K2)(he,"waveEdgedRectangle"),(0,i.K2)(de,"waveRectangle"),(0,i.K2)(ge,"windowPane"),(0,i.K2)(ye,"erBox"),(0,i.K2)(pe,"addText"),(0,i.K2)(fe,"textHelper"),(0,i.K2)(ue,"addText"),(0,i.K2)(me,"classBox"),(0,i.K2)(xe,"requirementBox"),(0,i.K2)(we,"addText");var be=(0,i.K2)((t=>{switch(t){case"Very High":return"red";case"High":return"orange";case"Medium":return null;case"Low":return"blue";case"Very Low":return"lightblue"}}),"colorFromPriority");async function Se(t,e,{config:a}){const{labelStyles:n,nodeStyles:s}=D(e);e.labelStyle=n||"";const l=e.width;e.width=(e.width??200)-10;const{shapeSvg:r,bbox:i,label:o}=await h(t,e,y(e)),p=e.padding||10;let f,u="";"ticket"in e&&e.ticket&&a?.kanban?.ticketBaseUrl&&(u=a?.kanban?.ticketBaseUrl.replace("#TICKET#",e.ticket),f=r.insert("svg:a",":first-child").attr("class","kanban-ticket-link").attr("xlink:href",u).attr("target","_blank"));const m={useHtmlLabels:e.useHtmlLabels,labelStyle:e.labelStyle||"",width:e.width,img:e.img,padding:e.padding||8,centerLabel:!1};let x,w;({label:x,bbox:w}=f?await d(f,"ticket"in e&&e.ticket||"",m):await d(r,"ticket"in e&&e.ticket||"",m));const{label:b,bbox:$}=await d(r,"assigned"in e&&e.assigned||"",m);e.width=l;const k=e?.width||0,v=Math.max(w.height,$.height)/2,M=Math.max(i.height+20,e?.height||0)+v,B=-k/2,K=-M/2;let C;o.attr("transform","translate("+(p-k/2)+", "+(-v-i.height/2)+")"),x.attr("transform","translate("+(p-k/2)+", "+(-v+i.height/2)+")"),b.attr("transform","translate("+(p+k/2-$.width-20)+", "+(-v+i.height/2)+")");const{rx:L,ry:N}=e,{cssStyles:R}=e;if("handDrawn"===e.look){const t=c.A.svg(r),a=A(e,{}),n=L||N?t.path(S(B,K,k,M,L||0),a):t.rectangle(B,K,k,M,a);C=r.insert((()=>n),":first-child"),C.attr("class","basic label-container").attr("style",R||null)}else{C=r.insert("rect",":first-child"),C.attr("class","basic label-container __APA__").attr("style",s).attr("rx",L??5).attr("ry",N??5).attr("x",B).attr("y",K).attr("width",k).attr("height",M);const t="priority"in e&&e.priority;if(t){const e=r.append("line"),a=B+2,n=K+Math.floor((L??0)/2),s=K+M-Math.floor((L??0)/2);e.attr("x1",a).attr("y1",n).attr("x2",a).attr("y2",s).attr("stroke-width","4").attr("stroke",be(t))}}return g(e,C),e.height=M,e.intersect=function(t){return F.rect(e,t)},r}(0,i.K2)(Se,"kanbanItem");var $e=[{semanticName:"Process",name:"Rectangle",shortName:"rect",description:"Standard process shape",aliases:["proc","process","rectangle"],internalAliases:["squareRect"],handler:Xt},{semanticName:"Event",name:"Rounded Rectangle",shortName:"rounded",description:"Represents an event",aliases:["event"],internalAliases:["roundedRect"],handler:Ot},{semanticName:"Terminal Point",name:"Stadium",shortName:"stadium",description:"Terminal point",aliases:["terminal","pill"],handler:Yt},{semanticName:"Subprocess",name:"Framed Rectangle",shortName:"fr-rect",description:"Subprocess",aliases:["subprocess","subproc","framed-rectangle","subroutine"],handler:Qt},{semanticName:"Database",name:"Cylinder",shortName:"cyl",description:"Database storage",aliases:["db","database","cylinder"],handler:gt},{semanticName:"Start",name:"Circle",shortName:"circle",description:"Starting point",aliases:["circ"],handler:Q},{semanticName:"Decision",name:"Diamond",shortName:"diam",description:"Decision-making step",aliases:["decision","diamond","question"],handler:zt},{semanticName:"Prepare Conditional",name:"Hexagon",shortName:"hex",description:"Preparation or condition step",aliases:["hexagon","prepare"],handler:bt},{semanticName:"Data Input/Output",name:"Lean Right",shortName:"lean-r",description:"Represents input or output",aliases:["lean-right","in-out"],internalAliases:["lean_right"],handler:Lt},{semanticName:"Data Input/Output",name:"Lean Left",shortName:"lean-l",description:"Represents output or input",aliases:["lean-left","out-in"],internalAliases:["lean_left"],handler:Ct},{semanticName:"Priority Action",name:"Trapezoid Base Bottom",shortName:"trap-b",description:"Priority action",aliases:["priority","trapezoid-bottom","trapezoid"],handler:ie},{semanticName:"Manual Operation",name:"Trapezoid Base Top",shortName:"trap-t",description:"Represents a manual task",aliases:["manual","trapezoid-top","inv-trapezoid"],internalAliases:["inv_trapezoid"],handler:At},{semanticName:"Stop",name:"Double Circle",shortName:"dbl-circ",description:"Represents a stop point",aliases:["double-circle"],internalAliases:["doublecircle"],handler:pt},{semanticName:"Text Block",name:"Text Block",shortName:"text",description:"Text block",handler:ae},{semanticName:"Card",name:"Notched Rectangle",shortName:"notch-rect",description:"Represents a card",aliases:["card","notched-rectangle"],handler:U},{semanticName:"Lined/Shaded Process",name:"Lined Rectangle",shortName:"lin-rect",description:"Lined process shape",aliases:["lined-rectangle","lined-process","lin-proc","shaded-process"],handler:Ft},{semanticName:"Start",name:"Small Circle",shortName:"sm-circ",description:"Small starting point",aliases:["start","small-circle"],internalAliases:["stateStart"],handler:Jt},{semanticName:"Stop",name:"Framed Circle",shortName:"fr-circ",description:"Stop point",aliases:["stop","framed-circle"],internalAliases:["stateEnd"],handler:Ut},{semanticName:"Fork/Join",name:"Filled Rectangle",shortName:"fork",description:"Fork or join in process flow",aliases:["join"],internalAliases:["forkJoin"],handler:mt},{semanticName:"Collate",name:"Hourglass",shortName:"hourglass",description:"Represents a collate operation",aliases:["hourglass","collate"],handler:St},{semanticName:"Comment",name:"Curly Brace",shortName:"brace",description:"Adds a comment",aliases:["comment","brace-l"],handler:nt},{semanticName:"Comment Right",name:"Curly Brace",shortName:"brace-r",description:"Adds a comment",handler:lt},{semanticName:"Comment with braces on both sides",name:"Curly Braces",shortName:"braces",description:"Adds a comment",handler:it},{semanticName:"Com Link",name:"Lightning Bolt",shortName:"bolt",description:"Communication link",aliases:["com-link","lightning-bolt"],handler:Nt},{semanticName:"Document",name:"Document",shortName:"doc",description:"Represents a document",aliases:["doc","document"],handler:he},{semanticName:"Delay",name:"Half-Rounded Rectangle",shortName:"delay",description:"Represents a delay",aliases:["half-rounded-rectangle"],handler:xt},{semanticName:"Direct Access Storage",name:"Horizontal Cylinder",shortName:"h-cyl",description:"Direct access storage",aliases:["das","horizontal-cylinder"],handler:re},{semanticName:"Disk Storage",name:"Lined Cylinder",shortName:"lin-cyl",description:"Disk storage",aliases:["disk","lined-cylinder"],handler:It},{semanticName:"Display",name:"Curved Trapezoid",shortName:"curv-trap",description:"Represents a display",aliases:["curved-trapezoid","display"],handler:ot},{semanticName:"Divided Process",name:"Divided Rectangle",shortName:"div-rect",description:"Divided process shape",aliases:["div-proc","divided-rectangle","divided-process"],handler:yt},{semanticName:"Extract",name:"Triangle",shortName:"tri",description:"Extraction process",aliases:["extract","triangle"],handler:ce},{semanticName:"Internal Storage",name:"Window Pane",shortName:"win-pane",description:"Internal storage",aliases:["internal-storage","window-pane"],handler:ge},{semanticName:"Junction",name:"Filled Circle",shortName:"f-circ",description:"Junction point",aliases:["junction","filled-circle"],handler:ft},{semanticName:"Loop Limit",name:"Trapezoidal Pentagon",shortName:"notch-pent",description:"Loop limit step",aliases:["loop-limit","notched-pentagon"],handler:oe},{semanticName:"Manual File",name:"Flipped Triangle",shortName:"flip-tri",description:"Manual file operation",aliases:["manual-file","flipped-triangle"],handler:ut},{semanticName:"Manual Input",name:"Sloped Rectangle",shortName:"sl-rect",description:"Manual input step",aliases:["manual-input","sloped-rectangle"],handler:Zt},{semanticName:"Multi-Document",name:"Stacked Document",shortName:"docs",description:"Multiple documents",aliases:["documents","st-doc","stacked-document"],handler:_t},{semanticName:"Multi-Process",name:"Stacked Rectangle",shortName:"st-rect",description:"Multiple processes",aliases:["procs","processes","stacked-rectangle"],handler:Wt},{semanticName:"Stored Data",name:"Bow Tie Rectangle",shortName:"bow-rect",description:"Stored data",aliases:["stored-data","bow-tie-rectangle"],handler:Y},{semanticName:"Summary",name:"Crossed Circle",shortName:"cross-circ",description:"Summary",aliases:["summary","crossed-circle"],handler:et},{semanticName:"Tagged Document",name:"Tagged Document",shortName:"tag-doc",description:"Tagged document",aliases:["tag-doc","tagged-document"],handler:ee},{semanticName:"Tagged Process",name:"Tagged Rectangle",shortName:"tag-rect",description:"Tagged process",aliases:["tagged-rectangle","tag-proc","tagged-process"],handler:te},{semanticName:"Paper Tape",name:"Flag",shortName:"flag",description:"Paper tape",aliases:["paper-tape"],handler:de},{semanticName:"Odd",name:"Odd",shortName:"odd",description:"Odd shape",internalAliases:["rect_left_inv_arrow"],handler:qt},{semanticName:"Lined Document",name:"Lined Document",shortName:"lin-doc",description:"Lined document",aliases:["lined-document"],handler:jt}],ke=(0,i.K2)((()=>{const t={state:Gt,choice:J,note:Et,rectWithTitle:Vt,labelRect:Kt,iconSquare:Mt,iconCircle:kt,icon:$t,iconRounded:vt,imageSquare:Dt,anchor:Z,kanbanItem:Se,classBox:me,erBox:ye,requirementBox:xe},e=[...Object.entries(t),...$e.flatMap((t=>[t.shortName,..."aliases"in t?t.aliases:[],..."internalAliases"in t?t.internalAliases:[]].map((e=>[e,t.handler]))))];return Object.fromEntries(e)}),"generateShapeMap")();function ve(t){return t in ke}(0,i.K2)(ve,"isValidShape");var Me=new Map;async function De(t,e,a){let n,s;"rect"===e.shape&&(e.rx&&e.ry?e.shape="roundedRect":e.shape="squareRect");const l=e.shape?ke[e.shape]:void 0;if(!l)throw new Error(`No such shape: ${e.shape}. Please check your syntax.`);if(e.link){let r;"sandbox"===a.config.securityLevel?r="_top":e.linkTarget&&(r=e.linkTarget||"_blank"),n=t.insert("svg:a").attr("xlink:href",e.link).attr("target",r??null),s=await l(n,e,a)}else s=await l(t,e,a),n=s;return e.tooltip&&s.attr("title",e.tooltip),Me.set(e.id,n),e.haveCallback&&n.attr("class",n.attr("class")+" clickable"),n}(0,i.K2)(De,"insertNode");var Ae=(0,i.K2)(((t,e)=>{Me.set(e.id,t)}),"setNodeElem"),Be=(0,i.K2)((()=>{Me.clear()}),"clear"),Ke=(0,i.K2)((t=>{const e=Me.get(t.id);i.Rm.trace("Transforming node",t.diff,t,"translate("+(t.x-t.width/2-5)+", "+t.width/2+")");const a=t.diff||0;return t.clusterNode?e.attr("transform","translate("+(t.x+a-t.width/2)+", "+(t.y-t.height/2-8)+")"):e.attr("transform","translate("+t.x+", "+t.y+")"),a}),"positionNode")}}]);
//# sourceMappingURL=a2bf56a3-26c1ea167afbe86785db.js.map